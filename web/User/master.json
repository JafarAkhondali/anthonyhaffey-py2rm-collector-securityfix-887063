{"boosts": {}, "exp_mgmt": {"any_loaded": true, "authenticated": false, "current_manager": "", "experiment": "class_vote_student", "experiments": {"testing": {"all_procs": {"Procedure.csv": [["Item", "Trial Type", "Max Time", "Text", "Shuffle 1", null], ["0", "Instruct", "user", "5 to 11 to 15", "off", null], ["0", "Instruct", "user", "2", "off", null], ["0", "Instruct", "user", "3", "off", null], ["0", "Instruct", "user", "4", "off", null], [null, null, null, null, null, null]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", null], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "", "random", "", "", 5, null], [null, null, null, null, null, null, null, null, null, null, null]], "Conditions.csv": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv"]], "all_stims": {"Stimuli.csv": [["Cue", "Answer", null], ["A", "Apple", null], ["B", "Banana", null], [null, null, null]]}, "procedure": null, "stimuli": null, "public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "google_script": null, "parsed_procs": {"Procedure.csv": [{"": "", "item": "0", "trial type": "instruct", "max time": "user", "text": "5 to 11 to 15", "shuffle 1": "off"}, {"": "", "item": "0", "trial type": "instruct", "max time": "user", "text": "2", "shuffle 1": "off"}, {"": "", "item": "0", "trial type": "instruct", "max time": "user", "text": "3", "shuffle 1": "off"}, {"": "", "item": "0", "trial type": "instruct", "max time": "user", "text": "4", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"Instruct": null, "instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "Stimuli.csv", "procedure": "Procedure.csv", "fullscreen": "off", "welcome": "", "participant_id": "on", "end_message": "", "start_message": "", "buffer": "5", "": ""}], "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec"}, "py2rm-spring-2020": {"all_procs": {"procedure.csv": [["item", "trial type", "max time", "text", "shuffle 1", "survey", ""], ["0", "instruct", "user", "Thank you for participating in this experiment.", "off", "\t", ""], ["2", "instruct", "user", "Thank you for participating in this experiment.", "off", "\t", ""], ["2 to 9", "finger_imitation", "user", "", "trials", "", ""], ["0", "survey", "user", "", "off", "demographics_py2rm_2020.csv", ""], ["", "", "", "", "", "", ""]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", "download_at_end", ""], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "", "random", "", "", "5", "off", ""], ["", ""]], "Conditions.csv": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv"]], "all_stims": {"stimuli.csv": [["Cue", "Answer", "face", "emotion", "gender", "identity", ""], ["A", "Apple", "AF01ANS.JPG", "angry", "female", "1", ""], ["B", "Banana", "AF01HAS.JPG", "happy", "female", "1", ""], ["", "", "AF02ANS.JPG", "angry", "female", "2", ""], ["", "", "AF02HAS.JPG", "happy", "female", "2", ""], ["", "", "AF03ANS.JPG", "angry", "female", "3", ""], ["", "", "AF03HAS.JPG", "happy", "female", "3", ""], ["", "", "AF04ANS.JPG", "angry", "female", "4", ""], ["", "", "AF04HAS.JPG", "happy", "female", "4", ""], ["", "", "AF05ANS.JPG", "angry", "female", "5", ""], ["", "", "AF05HAS.JPG", "happy", "female", "5", ""], ["", "", "AF06ANS.JPG", "angry", "female", "6", ""], ["", "", "AF06HAS.JPG", "happy", "female", "6", ""], ["", "", "AF07ANS.JPG", "angry", "female", "7", ""], ["", "", "AF07HAS.JPG", "happy", "female", "7", ""], ["", "", "AF08ANS.JPG", "angry", "female", "8", ""], ["", "", "AF08HAS.JPG", "happy", "female", "8", ""], ["", "", "AF09ANS.JPG", "angry", "female", "9", ""], ["", "", "AF09HAS.JPG", "happy", "female", "9", ""], ["", "", "AF10ANS.JPG", "angry", "female", "10", ""], ["", "", "AF10HAS.JPG", "happy", "female", "10", ""], ["", "", "AF11ANS.JPG", "angry", "female", "11", ""], ["", "", "AF11HAS.JPG", "happy", "female", "11", ""], ["", "", "AF12ANS.JPG", "angry", "female", "12", ""], ["", "", "AF12HAS.JPG", "happy", "female", "12", ""], ["", "", "AF13ANS.JPG", "angry", "female", "13", ""], ["", "", "AF13HAS.JPG", "happy", "female", "13", ""], ["", "", "AF14ANS.JPG", "angry", "female", "14", ""], ["", "", "AF14HAS.JPG", "happy", "female", "14", ""], ["", "", "AF15ANS.JPG", "angry", "female", "15", ""], ["", "", "AF15HAS.JPG", "happy", "female", "15", ""], ["", "", "AF16ANS.JPG", "angry", "female", "16", ""], ["", "", "AF16HAS.JPG", "happy", "female", "16", ""], ["", "", "AF17ANS.JPG", "angry", "female", "17", ""], ["", "", "AF17HAS.JPG", "happy", "female", "17", ""], ["", "", "AF18ANS.JPG", "angry", "female", "18", ""], ["", "", "AF18HAS.JPG", "happy", "female", "18", ""], ["", "", "AF19ANS.JPG", "angry", "female", "19", ""], ["", "", "AF19HAS.JPG", "happy", "female", "19", ""], ["", "", "AF20ANS.JPG", "angry", "female", "20", ""], ["", "", "AF20HAS.JPG", "happy", "female", "20", ""], ["", "", "AF21ANS.JPG", "angry", "female", "21", ""], ["", "", "AF21HAS.JPG", "happy", "female", "21", ""], ["", "", "AF22ANS.JPG", "angry", "female", "22", ""], ["", "", "AF22HAS.JPG", "happy", "female", "22", ""], ["", "", "AF23ANS.JPG", "angry", "female", "23", ""], ["", "", "AF23HAS.JPG", "happy", "female", "23", ""], ["", "", "AF24ANS.JPG", "angry", "female", "24", ""], ["", "", "AF24HAS.JPG", "happy", "female", "24", ""], ["", "", "AF25ANS.JPG", "angry", "female", "25", ""], ["", "", "AF25HAS.JPG", "happy", "female", "25", ""], ["", "", "AF26ANS.JPG", "angry", "female", "26", ""], ["", "", "AF26HAS.JPG", "happy", "female", "26", ""], ["", "", "AF27ANS.JPG", "angry", "female", "27", ""], ["", "", "AF27HAS.JPG", "happy", "female", "27", ""], ["", "", "AF28ANS.JPG", "angry", "female", "28", ""], ["", "", "AF28HAS.JPG", "happy", "female", "28", ""], ["", "", "AF29ANS.JPG", "angry", "female", "29", ""], ["", "", "AF29HAS.JPG", "happy", "female", "29", ""], ["", "", "AF30ANS.JPG", "angry", "female", "30", ""], ["", "", "AF30HAS.JPG", "happy", "female", "30", ""], ["", "", "AF31ANS.JPG", "angry", "female", "31", ""], ["", "", "AF31HAS.JPG", "happy", "female", "31", ""], ["", "", "AF32ANS.JPG", "angry", "female", "32", ""], ["", "", "AF32HAS.JPG", "happy", "female", "32", ""], ["", "", "AF33ANS.JPG", "angry", "female", "33", ""], ["", "", "AF33HAS.JPG", "happy", "female", "33", ""], ["", "", "AF34ANS.JPG", "angry", "female", "34", ""], ["", "", "AF34HAS.JPG", "happy", "female", "34", ""], ["", "", "AF35ANS.JPG", "angry", "female", "35", ""], ["", "", "AF35HAS.JPG", "happy", "female", "35", ""], ["", "", "AN01ANS.JPG", "angry", "male", "1", ""], ["", "", "AN01HAS.JPG", "happy", "male", "1", ""], ["", "", "AN02ANS.JPG", "angry", "male", "2", ""], ["", "", "AN02HAS.JPG", "happy", "male", "2", ""], ["", "", "AN03ANS.JPG", "angry", "male", "3", ""], ["", "", "AN03HAS.JPG", "happy", "male", "3", ""], ["", "", "AN04ANS.JPG", "angry", "male", "4", ""], ["", "", "AN04HAS.JPG", "happy", "male", "4", ""], ["", "", "AN05ANS.JPG", "angry", "male", "5", ""], ["", "", "AN05HAS.JPG", "happy", "male", "5", ""], ["", "", "AN06ANS.JPG", "angry", "male", "6", ""], ["", "", "AN06HAS.JPG", "happy", "male", "6", ""], ["", "", "AN07ANS.JPG", "angry", "male", "7", ""], ["", "", "AN07HAS.JPG", "happy", "male", "7", ""], ["", "", "AN08ANS.JPG", "angry", "male", "8", ""], ["", "", "AN08HAS.JPG", "happy", "male", "8", ""], ["", "", "AN09ANS.JPG", "angry", "male", "9", ""], ["", "", "AN09HAS.JPG", "happy", "male", "9", ""], ["", "", "AN10ANS.JPG", "angry", "male", "10", ""], ["", "", "AN10HAS.JPG", "happy", "male", "10", ""], ["", "", "AN11ANS.JPG", "angry", "male", "11", ""], ["", "", "AN11HAS.JPG", "happy", "male", "11", ""], ["", "", "AN12ANS.JPG", "angry", "male", "12", ""], ["", "", "AN12HAS.JPG", "happy", "male", "12", ""], ["", "", "AN13ANS.JPG", "angry", "male", "13", ""], ["", "", "AN13HAS.JPG", "happy", "male", "13", ""], ["", "", "AN14ANS.JPG", "angry", "male", "14", ""], ["", "", "AN14HAS.JPG", "happy", "male", "14", ""], ["", "", "AN15ANS.JPG", "angry", "male", "15", ""], ["", "", "AN15HAS.JPG", "happy", "male", "15", ""], ["", "", "AN16ANS.JPG", "angry", "male", "16", ""], ["", "", "AN16HAS.JPG", "happy", "male", "16", ""], ["", "", "AN17ANS.JPG", "angry", "male", "17", ""], ["", "", "AN17HAS.JPG", "happy", "male", "17", ""], ["", "", "AN18ANS.JPG", "angry", "male", "18", ""], ["", "", "AN18HAS.JPG", "happy", "male", "18", ""], ["", "", "AN19ANS.JPG", "angry", "male", "19", ""], ["", "", "AN19HAS.JPG", "happy", "male", "19", ""], ["", "", "AN20ANS.JPG", "angry", "male", "20", ""], ["", "", "AN20HAS.JPG", "happy", "male", "20", ""], ["", "", "AN21ANS.JPG", "angry", "male", "21", ""], ["", "", "AN21HAS.JPG", "happy", "male", "21", ""], ["", "", "AN22ANS.JPG", "angry", "male", "22", ""], ["", "", "AN22HAS.JPG", "happy", "male", "22", ""], ["", "", "AN23ANS.JPG", "angry", "male", "23", ""], ["", "", "AN23HAS.JPG", "happy", "male", "23", ""], ["", "", "AN24ANS.JPG", "angry", "male", "24", ""], ["", "", "AN24HAS.JPG", "happy", "male", "24", ""], ["", "", "AN25ANS.JPG", "angry", "male", "25", ""], ["", "", "AN25HAS.JPG", "happy", "male", "25", ""], ["", "", "AN26ANS.JPG", "angry", "male", "26", ""], ["", "", "AN26HAS.JPG", "happy", "male", "26", ""], ["", "", "AN27ANS.JPG", "angry", "male", "27", ""], ["", "", "AN27HAS.JPG", "happy", "male", "27", ""], ["", "", "AN28ANS.JPG", "angry", "male", "28", ""], ["", "", "AN28HAS.JPG", "happy", "male", "28", ""], ["", "", "AN29ANS.JPG", "angry", "male", "29", ""], ["", "", "AN29HAS.JPG", "happy", "male", "29", ""], ["", "", "AN30ANS.JPG", "angry", "male", "30", ""], ["", "", "AN30HAS.JPG", "happy", "male", "30", ""], ["", "", "AN31ANS.JPG", "angry", "male", "31", ""], ["", "", "AN31HAS.JPG", "happy", "male", "31", ""], ["", "", "AN32ANS.JPG", "angry", "male", "32", ""], ["", "", "AN32HAS.JPG", "happy", "male", "32", ""], ["", "", "AN33ANS.JPG", "angry", "male", "33", ""], ["", "", "AN33HAS.JPG", "happy", "male", "33", ""], ["", "", "AN34ANS.JPG", "angry", "male", "34", ""], ["", "", "AN34HAS.JPG", "happy", "male", "34", ""], ["", "", "AN35ANS.JPG", "angry", "male", "35", ""], ["", "", "AN35HAS.JPG", "happy", "male", "35", ""], ["", "", "", "", "", "", ""]]}, "procedure": null, "stimuli": null, "public_key": "qbLtY/WKogexV2MtzKeCjHng8DKNjOOmIfEnpj1Z90A=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"procedure.csv": [{"item": "0", "trial type": "instruct", "max time": "user", "text": "Thank you for participating in this experiment.", "shuffle 1": "off", "survey": "\t", "": ""}, {"item": "2", "trial type": "instruct", "max time": "user", "text": "Thank you for participating in this experiment.", "shuffle 1": "off", "survey": "\t", "": ""}, {"item": "2 to 9", "trial type": "finger_imitation", "max time": "user", "text": "", "shuffle 1": "trials", "survey": "", "": ""}, {"item": "0", "trial type": "survey", "max time": "user", "text": "", "shuffle 1": "off", "survey": "demographics_py2rm_2020.csv", "": ""}]}, "surveys": {"demographics_py2rm_2020": [["item_name", "text", "Type", "Answers", "Optional", "Values", null], ["Gender", "Gender", "likert", "Male|Female|Other", "No", "", null], ["Age", "Age", "Number", "", "No", "", null], ["Education", "Education (which level are you currently in, or is the highest you've completed)", "Dropdown", "Some high school| High school graduate| Some college, no degree| Associate's degree| Bachelor's degree|Graduate degree (Master's, Doctorate, etc.)", "No", "", null], ["English_Fluency", "Do you speak English fluently?", "likert", "Yes|No", "No", "", null], ["English_Age", "At what age did you start learning English? (write \"0\" if from birth)", "Number", "", "No", "", null], ["Country", "What is your country of residence?", "Text", "", "No", "", null], ["Handedness", "What is your preferred hand?", "Likert", "Left|Right|Both", "No", "", null], ["ethnicity", "If you would like to please state your ethnicity", "Dropdown", "Caucasian|East Asian|South Asian|African|Other", "Yes", "", null], ["", null]]}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>", "finger_imitation": "<style>\n#everything{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#face_image{\n/*  display:none; */\n}\n</style>\n<div id=\"everything\">\n  <div id=\"instructions\">\n    Please put your <b>right index finger</b> on the <b>N</b> key, and your <b>right middle finger</b> on the <b>M</b> key.\n  </div>\n  <img id=\"face_image\" src=\"../User/Stimuli/{{face}}\" />\n</div>\n<button onclick=\"Trial.submit()\">Proceed</button>\n\n<script>\n//detect when both the index and middle finger are down\n\n//$(\"#\")\n\n</script>", "finger imitation": null, "survey": "<!--\r\n  Author: Dr. Anthony Haffey\r\n\r\n  Collector: Cat/Kitten release\r\n  A program for running experiments on the web\r\n  Copyright 2012-2018 Mikey Garcia & Nate Kornell\r\n\r\n\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU General Public License version 3 as published by\r\n  the Free Software Foundation.\r\n\r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n\r\n  You should have received a copy of the GNU General Public License\r\n  along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n\r\n  Kitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\r\n-->\r\n<style>\r\ntd{\r\n  padding:10px;\r\n  vertical-align: top;\r\n}\r\n#content{\r\n  width:95%;\r\n}\r\n#proceed_button{\r\n  display:none;\r\n  float:right;\r\n}\r\n#this_survey_id{\r\n  padding:            20px;\r\n  display:            none;\r\n}\r\n#survey_outline{\r\n  background-color:   white;\r\n  color:              #0a3272;\r\n  border-radius:      20px;\r\n}\r\n#survey_tabs{\r\n  padding:            20px;\r\n}\r\n\r\n.btn-primary{\r\n\tcolor:#fff;\r\n\tbackground-color:#069;\r\n\tborder-color:#069;\r\n}\r\n.btn-primary:hover,\r\n.btn-primary:focus {\r\n  background-color: #09c;\r\n}\r\n\r\n.btn-primary:focus {\r\n  outline: 0;\r\n}\r\n\r\n.btn-primary:active {\r\n  background-color:#0f9;\r\n}\r\n.feedback_span_multiple{\r\n  display:none;\r\n  margin :10px;\r\n}\r\n.feedback_span_single{\r\n  display:none;\r\n  padding:10px;\r\n}\r\n.likert_table td{\r\n  padding:1px;\r\n  text-align:center;\r\n}\r\n.likert_table td:hover{\r\n  color:blue;\r\n}\r\n.score_total{\r\n  display:none;\r\n}\r\n.show_tab{\r\n  margin:5px;\r\n}\r\n.table_break{\r\n  width:100%;\r\n}\r\n</style>\r\n<div id=\"survey_outline\"></div>\r\n<script>\r\n/////////////////////////\r\n// Retrieving settings //\r\n/////////////////////////\r\n\r\nif(typeof(settings) !== \"undefined\"){\r\n  settings = [settings];\r\n} else {\r\n  settings = {};\r\n}\r\n\r\n//////////////////////////////////\r\n// vertical vs. horizontal tabs //\r\n//////////////////////////////////\r\n\r\nif(typeof(settings.tab_hor_vert) == \"undefined\" || settings.tab_hor_vert.toLowerCase() == \"horizontal\"){\r\n  settings.tab_hor_vert = \"horizontal\";\r\n  $(\"#survey_outline\").html(  '<div id=\"please_wait_div\">Loading... Please wait</div>'+\r\n                              '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>'+\r\n                              '<div id=\"survey_tabs\" style=\"text-align:right\" class=\"border-top border-primary\"></div><input type=\"submit\" value=\"Proceed\" class=\"btn btn-primary\" id=\"proceed_button\">');\r\n\r\n} else if (settings.tab_hor_vert.toLowerCase() == \"vertical\"){\r\n  $(\"#survey_outline\").html( '<table>'+\r\n                                '<tr>'+\r\n                                  '<td valign=\"top\" class=\"border-right border-primary\">'+\r\n                                    '<div id=\"survey_tabs\"></div></td>' +\r\n                                  '<td>'+\r\n                                    '<div id=\"please_wait_div\">Please wait while survey is downloading</div>'+\r\n                                    '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>' +\r\n                                    '<input type=\"button\" value=\"Proceed\" class=\"btn btn-primary\" id=\"proceed_button\">'+\r\n                                  '</td>'+\r\n                                '</tr>'+\r\n                              '</table>');\r\n} else if(settings.tab_hor_vert.toLowerCase() == \"none\"){\r\n  $(\"#survey_outline\").html(  '<div id=\"survey_tabs\" style=\"display:none\"></div>' +\r\n                              '<div id=\"please_wait_div\">Please wait while survey is downloading</div>'+\r\n                              '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>');\r\n} else {\r\n  bootbox.alert(\"If you are the researcher, please check the 'settings for this survey. The input for 'tab_hor_vert' appears to be invalid. Please change it to 'horizontal' or 'vertical' or 'none' or remove 'tab_hot_vert' altogether from the settings, which will make the tabs invisible\");\r\n}\r\n</script>\r\n\r\n<span id=\"scales_span\"></span>\r\n\r\n<script>\r\n\r\nString.prototype.replaceAll = function(str1, str2, ignore) {\r\n  //by qwerty at https://stackoverflow.com/questions/2116558/fastest-method-to-replace-all-instances-of-a-character-in-a-string\r\n  return this.replace(new RegExp(str1.replace(/([\\/\\,\\!\\\\\\^\\$\\{\\}\\[\\]\\(\\)\\.\\*\\+\\?\\|\\<\\>\\-\\&])/g,\"\\\\$&\"),(ignore?\"gi\":\"g\")),(typeof(str2)==\"string\")?str2.replace(/\\$/g,\"$$$$\"):str2);\r\n}\r\n\r\n\r\n//////////////////////\r\n// Defining objects //\r\n//////////////////////\r\n\r\npage_break_management = {\r\n  breaks_remaining : 0,\r\n  breaks_index     : 0\r\n}\r\n\r\nproceed_object = {\r\n  type:[],\r\n  name:[],\r\n  break_no:[]\r\n};\r\n\r\nscoring_object={\r\n  scales:[],\r\n  scale_scores:[],\r\n  update_scales:function(this_survey){\r\n    headers = Object.keys(this_survey[0]);\r\n    this.scales = headers.filter(elm => elm.includes(\"score:\"));\r\n    var scales_html = '';\r\n    this.scales.forEach(function(element){\r\n      element = element.replace(\": \",\":\");\r\n      scales_html += \"<input name='\"+element.replace(/ |:/g,\"_\")+\"' class='score_total \"+element.replace(/ |:/g,\"_\")+\"' disabled>\";\r\n    });\r\n    $(\"#scales_span\").html(scales_html);\r\n  }\r\n}\r\n\r\nsurvey_obj = {};\r\n\r\n\r\n/////////////////////\r\n// Element actions //\r\n/////////////////////\r\n\r\n/*\r\n$(function() {\r\n  $( \".datepicker\" ).datepicker({\r\n    dateFormat : 'mm/dd/yy',\r\n    changeMonth : true,\r\n    changeYear : true,\r\n    yearRange: '-100y:c+nn',\r\n    maxDate: '-1d'\r\n  });\r\n});\r\n*/\r\n\r\n\r\n$('#ExperimentContainer').css('transform','scale(1,1)');\r\n\r\n$(\"#proceed_button\").on(\"click\",function(){\r\n  var proceed = true;\r\n  var tabs    = document.getElementsByClassName('show_tab active');\r\n  if(tabs.length > 0){\r\n    var current_tab       = document.getElementsByClassName('show_tab active')[0].id.replace(\"_button\",\"\").replace(\"tab_\",\"\");\r\n    var response_elements = $('#table_'+current_tab).find('.response_element');\r\n\r\n  } else {\r\n    response_elements = $(\".table_break:visible\").find(\".response_element\");\r\n    //response_elements     = $('.response_element');\r\n  }\r\n\r\n  for(var i = 0; i < response_elements.length; i++){\r\n    [this_row_no,item_name] = retrieve_row_no_item_name(response_elements[i]);\r\n    var this_optional = survey_obj.data[this_row_no].optional.toLowerCase();\r\n\r\n    if(this_optional.indexOf(\"no\") !== -1){\r\n      this_optional = this_optional.split(\"-\");       // find out whether there's a minimal number of responses\r\n      if(this_optional.length == 1){                  // default is that length needs to be at least 1\r\n        var min_resp_length = 1;\r\n      } else if(this_optional.length == 2) {\r\n        var min_resp_length = this_optional[1];\r\n      } else {\r\n        bootbox.alert(\"Error - you appear to have too many '-' characters in the 'optional' column\");\r\n        return false;\r\n      }\r\n    } else {\r\n      min_resp_length = 0;\r\n    }\r\n\r\n    var quest_resp = isJSON($(\"#\"+response_elements[i].id).val());\r\n    if (quest_resp.length < min_resp_length){\r\n      proceed = false;\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).removeClass(\"text-success\");\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).addClass(\"text-danger\");\r\n    } else {\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).removeClass(\"text-danger\");\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).addClass(\"text-success\");\r\n    }\r\n  }\r\n\r\n  if(current_tab == survey_obj.tabs && proceed){\r\n    if(typeof(sql_surveys) == \"undefined\"){\r\n      //$(\".table_break\");\r\n      console.dir('$(\".table_break:visible\")');\r\n      console.dir($(\".table_break:visible\"));\r\n      var next_table_no = parseFloat($(\".table_break:visible\")[0].id.replace(\"table\",\"\")) + 1;\r\n      console.dir(\"next_table_no\");\r\n      console.dir(next_table_no);\r\n      console.dir($(\".table_break#table_\"+next_table_no));\r\n\r\n      if($(\".table_break#table\"+next_table_no).length == 0){\r\n        if(typeof(Trial) !== \"undefined\"){\r\n          Trial.submit();\r\n        } else {\r\n          bootbox.alert(\"You've finished! Click on the preview button to restart.\")\r\n        }\r\n      } else {\r\n        $(\".table_break\").hide();\r\n        $(\".table_break#table\" + next_table_no).show();\r\n      }\r\n    } else {\r\n      $(\"#survey_outline\").html(\"<h1> You have finished the preview of this survey.</h1>\");\r\n    }\r\n  } else if(current_tab < survey_obj.tabs && proceed) {\r\n    current_tab ++;\r\n    $(\"#tab_\"+current_tab+\"_button\").removeClass(\"btn-secondary\");\r\n    $(\"#tab_\"+current_tab+\"_button\").removeClass(\"disabled\");\r\n    $(\"#tab_\"+current_tab+\"_button\").addClass(\"btn-outline-primary\");\r\n    $(\"#tab_\"+current_tab+\"_button\").click();\r\n  } else if(proceed == false){\r\n    bootbox.alert(\"You have failed to complete at least one compulsory input.\");\r\n  } else if(current_tab > survey_obj.tabs){\r\n    bootbox.alert(\"Error - please contact the Collector team about this problem, error 'Survey_001'.\");\r\n  }\r\n});\r\n\r\n\r\n///////////////\r\n// Functions //\r\n///////////////\r\n\r\n\r\nfunction load_survey(survey){\r\n  // are we in preview?\r\n  /////////////////////\r\n  console.dir(\"survey\");\r\n  console.dir(survey);\r\n  if(typeof(master_json) !== \"undefined\" && master_json.surveys.preview){     // Yes\r\n    survey_content = survey;                                                    // i.e. the content has been passed through directly\r\n    survey_obj.boosts = master_json.boosts;                                //no need to be efficient in preview\r\n\r\n  } else {                                                                      // No\r\n    survey = survey.toLowerCase().replace(\".csv\",\"\") + \".csv\";\r\n\r\n    if(typeof(parent.parent.exp_json.surveys) !== \"undefined\" && \r\n       typeof(parent.parent.exp_json.surveys[survey]) !== \"undefined\"){\r\n      survey_content = parent.parent.exp_json.surveys[survey];\r\n      survey_obj.boosts = parent.parent.exp_json.boosts;                     //take boosts from exp_json\r\n\r\n    } else {\r\n      bootbox.alert(\"Survey \" + survey  + \" doesn't appear to exist\");\r\n    }\r\n  }\r\n  process_returned_questionnaire(survey_content);\r\n}\r\n\r\nfunction generate_feedback_string(feedback_array,this_index,feedback_color,row_no,this_row){\r\n  if(feedback_array){                 //i.e. if it's not null\r\n    if(feedback_array.length > 1){\r\n      return \"<div class='feedback_span_multiple \"+this_row[\"item_name\"].toLowerCase()+\"_feedback' style='color:\"+feedback_color[this_index]+\"'>\"+feedback_array[this_index]+\"</div>\";\r\n    } else {\r\n      return \"<div class='feedback_span_single \"+this_row[\"item_name\"].toLowerCase()+\"_feedback' style='color:\"+feedback_color[this_index]+\"'>\"+feedback_array[this_index]+\"</div>\";\r\n    }\r\n  } else {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction isJSON(str) {\r\n  try {\r\n    return JSON.parse(str);\r\n  } catch (e) {\r\n    return str;\r\n  }\r\n}\r\n\r\n\r\nfunction likert_update(this_element,this_response,this_value){\r\n  [row_no,item_name] = retrieve_row_no_item_name(this_element);\r\n  $(\".row_\"+row_no).removeClass(\"active\");\r\n  $(\".row_\"+row_no).removeClass(\"btn-primary\");\r\n  $(\".row_\"+row_no).addClass(\"btn-outline-primary\");\r\n  $(this_element).removeClass(\"btn-outline-primary\");\r\n  $(this_element).addClass(\"btn-primary\");\r\n  $(\"#survey_\"+item_name+\"_response\").val(this_response);\r\n  response_check(this_element);\r\n}\r\n  console.dir(\"breaking near here? huh?\");\r\n\r\nfunction process_item_score(survey_obj,row_no,values_col,this_response,item,values_reverse){\r\n  console.dir(\"breaking near here?\");\r\n  item_values       = survey_obj.data[row_no][values_col].split(\"|\");\r\n  if(typeof(values_reverse) !== \"undefined\" && values_reverse == \"r\"){\r\n    item_values.reverse();\r\n  }\r\n  item_answers      = survey_obj.data[row_no][\"answers\"].split(\"|\");\r\n  var this_value    = item_values[item_answers.indexOf(this_response)];\r\n  $(\"#survey_\" + item + \"_score\").val(this_value);\r\n  if(typeof(this_value) !== \"undefined\"){\r\n    return parseFloat(this_value);\r\n  }\r\n}\r\n\r\nfunction process_returned_questionnaire(data){\r\n  survey_obj.data = data;\r\n  survey_obj.data = Papa.parse(Papa.unparse(survey_obj.data),{\r\n                      header:true,\r\n                      beforeFirstChunk: function(chunk) {\r\n                        var rows = chunk.split( /\\r\\n|\\r|\\n/ );\r\n                        var headings = rows[0].toLowerCase();\r\n                        rows[0] = headings;\r\n                        return rows.join(\"\\r\\n\");\r\n                      },\r\n                    }).data;\r\n\r\n  var col_headers = Object.keys(survey_obj.data[0]);\r\n  survey_obj.scales = {};\r\n\r\n  col_headers.forEach(function(header){\r\n    if(header.indexOf(\"score:\")==0){\r\n      var original_header = header;\r\n      header = header.replace(\"score: \",\"\");\r\n      header = header.replace(\"score:\",\"\");\r\n\r\n      survey_obj.scales[header] = {};\r\n      survey_obj.scales[header].questions = {};\r\n\r\n      //identify which questions\r\n      for(var i = 1; i< survey_obj.data.length; i++){\r\n        row = survey_obj.data[i];\r\n        if(row[original_header] !== \"\" && typeof(row[original_header]) !== \"undefined\"){\r\n          survey_obj.scales[header].questions[i] = row[original_header];\r\n        }\r\n      }\r\n    }\r\n  });\r\n  write_survey(survey_obj.data,\"this_survey_id\");\r\n  $(\"#please_wait_div\").hide();\r\n  $(\"#proceed_button\").show();\r\n\r\n  $('html, body').animate({\r\n    scrollTop: $(\"#survey_outline\").offset().top\r\n  }, 1000);\r\n}\r\n\r\nfunction process_survey_question(this_row,row_no){\r\n\r\n  if(this_row.values == \"\"){\r\n    this_row.values = this_row.answers;\r\n  }\r\n\r\n  if(typeof(this_row[\"text\"]) !== \"undefined\" && typeof(this_row[\"type\"]) !== \"undefined\" && this_row['text'].toLowerCase() == \"page_break\" | this_row['type'].toLowerCase() == \"page_break\"){\r\n        page_break_management.breaks_remaining++;\r\n        question_td = \"</tr></table><table id='table\"+page_break_management.breaks_remaining+\"' style='display:none' class='table_break'></tr>\";\r\n  } else {\r\n\r\n    if(typeof(this_row[\"values\"]) !== \"undefined\" & typeof(this_row[\"values\"]) !== \"function\"){ //to address microsoft edge issue.\r\n      value_array = this_row[\"values\"].split(\"|\");\r\n    } else {\r\n      value_array='';\r\n    }\r\n\r\n    if(this_row[\"item_name\"].indexOf(\" \") !== -1){\r\n      bootbox.alert(\"Please note that the 'item name' '\" + this_row['item_name'] + \"' is invalid because it has at least one space. Please use underscores instead of spaces. If you're not the creator of this task, please contact the person who created it.\");\r\n    }\r\n\r\n    // class for scoring\r\n    this_class = \"\";\r\n    for(var i=0;i<scoring_object.scales.length;i++){\r\n      if(this_row[scoring_object.scales[i].toLowerCase()]==\"1\"){\r\n        this_class += scoring_object.scales[i].toLowerCase().replace(\"score: \",\"\").replace(/ |-/,\"\")+\" \";\r\n      }\r\n      if(this_row[scoring_object.scales[i].toLowerCase()]==\"r1\"){\r\n        this_class += scoring_object.scales[i].toLowerCase().replace(\"score: \",\"\").replace(\" \",\"_\")+\"-r1 \";\r\n      }\r\n    }\r\n\r\n    [feedback_array,feedback_color] = retrieve_feedback(this_row);\r\n\r\n    response_html = '<input type=\"hidden\" class=\"response_element row_'+row_no+'\" id=\"survey_'+this_row[\"item_name\"].toLowerCase()+'_response\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'_response\"  value=\"\">';\r\n\r\n\r\n    // Survey settings\r\n    ////////////////////\r\n\r\n    [row_ques_perc,row_resp_perc] = quest_resp_perc(settings.quest_resp_rat);\r\n\r\n    if(typeof(settings.feedback_before_response) == \"undefined\"){\r\n        settings.feedback_before_response = true;\r\n    }\r\n\r\n    if(typeof(settings.lock_after_feedback) == \"undefined\"){\r\n        settings.lock_after_feedback = false;\r\n    }\r\n    var question_td='';\r\n\r\n    if(typeof(this_row[\"type\"]) == \"undefined\"){\r\n        return false;\r\n    }\r\n\r\n    // Item types\r\n    ///////////////\r\n\r\n    if(typeof(survey_obj.boosts) !== \"undefined\" && typeof(survey_obj.boosts[this_row.type]) !== \"undefined\"){\r\n\r\n      var boost_html = survey_obj.boosts[this_row.type].contents;\r\n      console.dir(boost_html);\r\n\r\n      //for each row variable, insert it into the boost if possible?\r\n      Object.keys(this_row).forEach(function(attribute){\r\n        console.dir(boost_html);\r\n        boost_html = boost_html.replaceAll(\"{{\"+attribute+\"}}\",this_row[attribute]);\r\n      });\r\n      question_td += boost_html;\r\n    } else {\r\n\r\n      switch(this_row[\"type\"].toLowerCase()){\r\n        case \"page_start\":\r\n          var tabs_html = $(\"#survey_tabs\").html();\r\n          if(settings.tab_hor_vert == \"horizontal\"){\r\n            span_div = \"span\";\r\n          } else if(settings.tab_hor_vert == \"vertical\"){\r\n            span_div = \"div\";\r\n          }\r\n          if(typeof(survey_obj.tabs) == \"undefined\"){\r\n            survey_obj.tabs = 0;\r\n          } else {\r\n            survey_obj.tabs++;\r\n          }\r\n          if(survey_obj.tabs == 0){ //i.e. is the first tab\r\n            active_button = \"btn-outline-primary active\";\r\n          } else {\r\n            active_button = \"btn-secondary disabled\";\r\n          }\r\n          if(settings.tab_hor_vert == \"vertical\"){\r\n            var vert_btn_block = \"btn-block\";\r\n          } else {\r\n            var vert_btn_block = \"\";\r\n          }\r\n\r\n          tabs_html +=  '<'+span_div+' class=\"btn-group-toggle\" data-toggle=\"buttons\">'+\r\n            '<label id=\"tab_' + survey_obj.tabs + '_button\" class=\"btn show_tab '+active_button+' '+vert_btn_block+'\">'+\r\n              '<input type=\"checkbox\" checked autocomplete=\"off\">'+ this_row['text'] +\r\n            '</label>'+\r\n          '</'+span_div+'>';\r\n\r\n          $(\"#survey_tabs\").html(tabs_html);\r\n\r\n          page_break_indexes = [];\r\n          survey_obj.data.forEach(function(this_row,this_index){\r\n            if(typeof(this_row.type) !== \"undefined\" && this_row.type.toLowerCase() == \"page_start\"){\r\n              page_break_indexes.push(this_index);\r\n            }\r\n          });\r\n\r\n          if(survey_obj.tabs>0){\r\n            question_td += \"</td><td></td></tr></table></div><div class='survey_page' id='tab_\"+survey_obj.tabs+\"' style='display:none'><table id='table_\"+survey_obj.tabs+\"' class='table_break'><tr>\";\r\n          } else {\r\n            question_td += \"</td><td></td></tr></table><div class='survey_page' id='tab_\"+survey_obj.tabs+\"' ><table id='table_\"+survey_obj.tabs+\"' class='table_break'><tr>\";\r\n          }\r\n        break;\r\n\r\n        case \"checkbox\":\r\n        case \"checkbox_vertical\":\r\n          var options = this_row[\"answers\"].split(\"|\");\r\n          question_td +=  response_html;\r\n          for(var i=0; i<options.length;i++){\r\n            feedback_string = generate_feedback_string(feedback_array,i,feedback_color,row_no,this_row);\r\n            question_td +=  '<div class=\"custom-control custom-checkbox\">'+\r\n                '<input type=\"checkbox\" class=\"custom-control-input '+this_class+' custom-control custom-checkbox '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                feedback_string +\r\n            '</div>';\r\n          }\r\n          break;\r\n\r\n          case \"checkbox_horizontal\":\r\n            feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n            var options = this_row[\"answers\"].split(\"|\");\r\n            question_td += response_html;\r\n            question_td += '<table><tr>';\r\n            for(var i=0; i<options.length;i++){\r\n              question_td +=  '<td>'+\r\n                                '<div class=\"custom-control custom-checkbox\">'+\r\n                                  '<input type=\"checkbox\" class=\"custom-control-input '+this_class+' custom-control custom-checkbox '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                    '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                '</div>'+\r\n                              '</td>';\r\n            }\r\n            question_td += '</tr></table>'+feedback_string;\r\n          break;\r\n\r\n          case \"checkbox_single\":\r\n            feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n            var this_option = this_row[\"answers\"];\r\n            question_td +=  response_html +\r\n                            '<div class=\"btn-group-toggle\" data-toggle=\"buttons\">'+\r\n                                '<label class=\"btn btn-outline-primary\">'+\r\n                                    '<input type=\"checkbox\" class=\"'+this_row[\"item_name\"]+'_item row_'+row_no+'\"  checked autocomplete=\"off\" id=\"'+this_row[\"item_name\"]+'\" onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+ this_option +\r\n                                '</label>'+\r\n                            '</div>' + feedback_string;\r\n          break;\r\n\r\n          case \"date\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td+=   response_html+\r\n                              \"<input onchange='response_check(this)' class='custom-control datepicker date \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\"+\r\n                              feedback_string;\r\n          break;\r\n\r\n          case \"dropdown\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              var options = this_row[\"answers\"].split(\"|\");\r\n              question_td += response_html +\r\n                                  '<select class=\"custom-select '+this_row[\"item_name\"]+'_item row_'+row_no+'\" onchange=\"response_check(this)\" collector_button\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                      '<option selected disabled hidden>-- no option selected --</option>';\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td += \"<option>\"+options[i]+\"</option>\";\r\n              }\r\n              question_td += '</select>'+feedback_string;\r\n          break;\r\n\r\n          case \"email\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<input class='form-control type='email' \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"google_slide\":\r\n          case \"instruct\":\r\n              //question_td += </td>\"; // \"<span class='text-primary'>\" + this_row[\"text\"] + \"</span>\";\r\n          break;\r\n\r\n          // tidy up this code for nice looking buttons\r\n          case \"likert\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              console.dir(\"break coming up, ja?\");\r\n              console.dir(this_row);\r\n              var options  = this_row[\"answers\"].split(\"|\");\r\n              if(typeof(this_row[\"values\"]) == \"undefined\"){\r\n                this_row[\"values\"] = this_row[\"answers\"];\r\n              }\r\n              var values   = this_row[\"values\"].split(\"|\");\r\n              question_td += \"<table class='likert_table'><tr>\" +\r\n                                  '<td>'+\r\n                                      response_html +\r\n                                      '<div class=\"btn-group btn-group-toggle\" data-toggle=\"buttons\">'; //to help detect blank likert's\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td+=   '<button type=\"button\" class=\"btn btn-outline-primary '+this_row[\"item_name\"]+'_item row_'+row_no+'\"  autocomplete=\"off\" id=\"likert_'+row_no+'_'+i+'\"  onclick=\"likert_update(this,\\''+options[i]+'\\',\\''+values[i]+'\\')\">'+options[i]+'</button>';\r\n\r\n              }\r\n              question_td +=  \"</div>\"+\r\n                              \"<input type='hidden' class='\"+this_class+\"' id='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score' name='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score'>\"+\r\n                          \"</td>\"+\r\n                      \"</tr>\"+\r\n                  \"</table>\"+feedback_string;\r\n          break;\r\n\r\n          case \"number\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html +\"<input type='number'  onchange='response_check(this)' class='form-control \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\" + feedback_string;\r\n          break;\r\n\r\n          case \"para\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<textarea name='survey_\"+this_row['item_name'].toLowerCase()+\"' class='\"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' style='width:100%;height:200px'></textarea>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"radio\":\r\n          case \"radio_vertical\":\r\n            var options = this_row[\"answers\"].split(\"|\");\r\n            var values   = this_row[\"values\"].split(\"|\");\r\n            question_td +=  response_html;\r\n            for(var i=0; i<options.length;i++){\r\n              feedback_string = generate_feedback_string(feedback_array,i,feedback_color,row_no,this_row);\r\n\r\n              question_td +=  '<div class=\"custom-control custom-radio\">'+\r\n                                '<input type=\"radio\" class=\"custom-control-input '+this_class+'  onclick=\"likert_update(this,\\''+options[i]+'\\',\\''+values[i]+'\\')\" custom-control custom-radio '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" value=\"' + options[i] + '\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                  feedback_string +\r\n                              '</div>';\r\n\r\n\r\n            }\r\n            question_td +=  \"<input type='hidden' class='\"+this_class+\"' id='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score' name='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score'>\";\r\n          break;\r\n\r\n          case \"radio_horizontal\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              var options = this_row[\"answers\"].split(\"|\");\r\n              question_td +=  response_html;\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td +=  '<div class=\"custom-control custom-radio custom-control-inline\">'+\r\n                                      '<input type=\"radio\" class=\"custom-control-input '+this_class+' custom-control custom-radio '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                      '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                      '<div class=\"invalid-feedback\">Example invalid feedback text</div>'+\r\n                                  '</div>'\r\n              }\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"report_score\":\r\n              question_td += \"<input disabled class='form-control score_\" + this_row[\"item_name\"] + \" \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n          break;\r\n\r\n          case \"text\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<input class='form-control \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n      }\r\n    }\r\n    if(feedback_array){\r\n        question_td += \"<button class='btn btn-outline-info feedback_btn \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' data-toggle='tooltip' id='reveal_\"+this_row[\"item_name\"].toLowerCase()+\"_feedback'  onclick='reveal_answers(this)'>Show</button>\";\r\n    }\r\n  }\r\n//  question_td += '</td>';\r\n\r\n  if(typeof(this_row[\"type\"])== \"undefined\"){\r\n      return '';\r\n  } else {\r\n    if(this_row[\"type\"].toLowerCase()==\"instruct\"){\r\n      var this_row_html=\"<td colspan='2' class='text-primary'>\"+this_row[\"text\"]+\"</label></td>\";\r\n    } else if(this_row[\"type\"].toLowerCase()==\"google_slide\") {\r\n      var this_row_html=\"<td colspan='2'>\"+this_row[\"text\"]+\"</label></td>\";\r\n    } else if(typeof(this_row[\"no_text\"]) !== \"undefined\" && this_row[\"no_text\"] == \"on\"){\r\n      var this_row_html=\"<td colspan='2'>\"+question_td+\"</td>\";\r\n    } else {\r\n      if(this_row['text'].toLowerCase() == \"page_start\" | this_row['type'].toLowerCase() == \"page_start\"){\r\n        this_row_html = question_td;\r\n      }else {\r\n        var this_row_html=\"<td id='survey_\"+this_row[\"item_name\"].toLowerCase().replace(\" \",\"_\")+\"_question' style='width:\"+row_ques_perc+\"'>\"+this_row[\"text\"]+\"</td><td>\"+question_td+\"</label></td>\";\r\n      }\r\n    }\r\n    if(typeof(this_row[\"optional\"]) !== \"undefined\"){\r\n      if(this_row[\"optional\"].toLowerCase() == \"no\"){\r\n        proceed_object.name.push(this_row[\"item_name\"]);\r\n        proceed_object.type.push(this_row[\"type\"]);\r\n        proceed_object.break_no.push(page_break_management.breaks_remaining);\r\n      }\r\n    }\r\n    if(typeof(this_row[\"shuffle\"]) == \"undefined\" || this_row[\"shuffle\"].toLowerCase() == \"off\"){\r\n      this_shuffle='none';\r\n    } else {\r\n      this_shuffle=this_row[\"shuffle\"];\r\n    }\r\n    return [this_row_html,this_shuffle];\r\n  }\r\n}\r\n\r\nfunction quest_resp_perc(quest_resp_rat){\r\n  if(typeof(quest_resp_rat) == \"undefined\"){\r\n    row_resp_perc = \"35%\";\r\n    row_ques_perc = \"65%\";\r\n  } else {\r\n    row_resp_perc = parseFloat(100-quest_resp_rat.replace(\"%\",\"\"))+\"%\";\r\n    row_ques_perc = parseFloat(quest_resp_rat.replace(\"%\",\"\"))+\"%\";\r\n  }\r\n  return [row_ques_perc,row_resp_perc];\r\n}\r\n\r\nfunction response_check(submitted_element){\r\n  switch(submitted_element.type){\r\n    case \"checkbox\":\r\n      var checked_responses = $(\"[name='\"+submitted_element.name+\"']:checked\");\r\n      if(checked_responses.length){ //i.e. more than 0\r\n        var values = [];\r\n        for(var i = 0; i < checked_responses.length; i++){\r\n          values.push(checked_responses[i].value);\r\n        }\r\n        $(\"#\"+submitted_element.name+\"_response\").val(JSON.stringify(values));\r\n      } else {\r\n        $(\"#\"+submitted_element.name+\"_response\").val(\"\");\r\n      }\r\n      break;\r\n\r\n      case \"button\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.innerHTML);\r\n      break;\r\n\r\n      case \"number\":\r\n      case \"select-one\":\r\n      case \"text\":\r\n      case \"textarea\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.value);\r\n      break;\r\n\r\n\r\n      case \"radio\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.value);\r\n      break;\r\n    }\r\n    update_score();\r\n}\r\n\r\nfunction retrieve_feedback(this_row){\r\n  if(typeof(this_row[\"feedback\"]) !== \"undefined\" && this_row[\"feedback\"] !== \"\"){\r\n    feedback_array = this_row[\"feedback\"].split(\"|\");\r\n    if(typeof(this_row[\"feedback_color\"]) == \"undefined\"){\r\n      bootbox.alert(\"The color for the feedback options has not been set. If you created this questionnaire, please add a column 'feedback_color' to your survey and separate the colors by a pipe (|) character.\");\r\n    }\r\n    feedback_color = this_row[\"feedback_color\"].split(\"|\");\r\n  } else {\r\n    feedback_array = null;\r\n    feedback_color = '';\r\n  }\r\n  return [feedback_array,feedback_color];\r\n}\r\n\r\nfunction retrieve_row_no_item_name(this_element){\r\n  var these_classes = this_element.className.split(\" \");\r\n  var row_no;\r\n  var item_name;\r\n  these_classes.forEach(function(this_class){\r\n    if (this_class.indexOf('row_') > -1) {\r\n      row_no = this_class.replace(\"row_\",\"\");\r\n    }\r\n    if (this_class.indexOf('_item') > -1) {\r\n      item_name = this_class.replace(\"_item\",\"\").toLowerCase();\r\n    }\r\n  });\r\n  return [row_no,item_name];\r\n}\r\n\r\nfunction reveal_answers(this_element){\r\n  var this_response = $(\"#\"+this_element.id.replace(\"reveal_\",\"survey_\").replace(\"_feedback\",\"_response\")).val();\r\n  response_present = this_response == \"\" ? false : true;\r\n\r\n  if(settings.feedback_before_response == false && response_present == false){\r\n    bootbox.alert(\"Please respond before trying reveal the feedback.\")\r\n  } else {\r\n    if($(\"#\"+this_element.id).hasClass(\"btn-outline-info\")){\r\n      $(\".\"+this_element.id.replace(\"reveal_\",\"\")).show(500);\r\n      if(settings.lock_after_feedback){\r\n        var item_class = this_element.id.replace(\"_feedback\",\"_item\").replace(\"reveal_\",\"\");\r\n        $(\".\"+item_class).prop(\"disabled\",true);\r\n        document.getElementsByClassName(item_class).title = \"The person creating this content has set it so that your answers are locked in once you have chosen to see the feedback\";\r\n        $(\"#\"+this_element.id).addClass(\"btn-info\");\r\n        $(\"#\"+this_element.id).removeClass(\"btn-outline-info\");\r\n        $(\"#\"+this_element.id).html(\"Locked\");\r\n        document.getElementById(this_element.id).title = 'The person creating this content has set it so that your answers are locked in once you have chosen to see the feedback';\r\n        $(\"#\"+this_element.id).addClass(\"disabled\");\r\n      } else {\r\n        $(\"#\"+this_element.id).html(\"Hide\");\r\n        $(\"#\"+this_element.id).removeClass(\"btn-outline-info\");\r\n        $(\"#\"+this_element.id).addClass(\"btn-info\");\r\n      }\r\n    } else {\r\n      $(\"#\"+this_element.id).html(\"Show\");\r\n      $(\".\"+this_element.id.replace(\"reveal_\",\"\")).hide(500);\r\n      $(\"#\"+this_element.id).addClass(\"btn-outline-info\");\r\n      $(\"#\"+this_element.id).removeClass(\"btn-info\");\r\n    }\r\n  }\r\n}\r\n\r\nfunction shuffle(array) {                                   // http://stackoverflow.com/questions/962802#962890\r\n  var tmp, current, top = array.length;\r\n  if(top) while(--top) {\r\n    current = Math.floor(Math.random() * (top + 1));\r\n    tmp = array[current];\r\n    array[current] = array[top];\r\n    array[top] = tmp;\r\n  }\r\n  return array;\r\n}\r\n\r\nfunction update_score(){\r\n  var scales = Object.keys(survey_obj.scales);\r\n  scales.forEach(function(scale){\r\n    this_scale = survey_obj.scales[scale];\r\n    var questions = Object.keys(this_scale.questions);\r\n    var this_score = 0;\r\n    complete_score = true;\r\n\r\n    questions.forEach(function(row_no){\r\n      var item = survey_obj.data[row_no].item_name.toLowerCase();\r\n      var this_response = $(\"#survey_\"+item+\"_response\").val(); //response\r\n      var normal_reverse = this_scale.questions[row_no];\r\n\r\n      if(normal_reverse.indexOf(\"-\") == -1){\r\n        var multiplier = parseFloat(normal_reverse.replace(\"r\",\"\"));\r\n        if(normal_reverse.indexOf(\"r\") == 0){ //reverse the values\r\n          this_value = process_item_score(survey_obj,row_no,\"values\",this_response,item,\"r\");\r\n        } else {\r\n          this_value = process_item_score(survey_obj,row_no,\"values\",this_response,item);\r\n        }\r\n      } else {\r\n        values_reverse = normal_reverse.split(\"-\");\r\n        values_col     = values_reverse[0].toLowerCase();\r\n        normal_reverse = values_reverse[1];\r\n        var multiplier = parseFloat(normal_reverse.replace(\"r\",\"\"));\r\n\r\n        if(normal_reverse.indexOf(\"r\") == 0){ //reverse the values\r\n          this_value = process_item_score(survey_obj,row_no,values_col,this_response,item,\"r\");\r\n        } else {\r\n          this_value = process_item_score(survey_obj,row_no,values_col,this_response,item);\r\n        }\r\n      }\r\n      if(typeof(this_value) !== \"undefined\"){\r\n        this_score += multiplier * this_value;\r\n      } else {\r\n        complete_score = false;\r\n      }\r\n    });\r\n    if(complete_score){\r\n      $(\".score_\"+scale).addClass(\"bg-success\");\r\n      $(\".score_\"+scale).removeClass(\"bg-danger\");\r\n      $(\".score_\"+scale).addClass(\"text-light\");\r\n      document.getElementsByClassName(\"score_\"+scale).title = 'All relevant questions have been answered';\r\n    } else {\r\n      $(\".score_\"+scale).removeClass(\"text-success\");\r\n      $(\".score_\"+scale).addClass(\"bg-danger\");\r\n      $(\".score_\"+scale).addClass(\"text-light\");\r\n      document.getElementsByClassName(\"score_\"+scale).title = 'At least one relevant questions has NOT been answered';\r\n    }\r\n    $(\".score_\"+scale).val(this_score);\r\n  });\r\n}\r\n\r\nfunction write_survey(this_survey,this_id){\r\n  scoring_object.update_scales(this_survey);\r\n  this_survey_html=\"<table class='table_break' id='table0'>\";\r\n  this_survey_object={\r\n    content:[],\r\n    shuffle:[],\r\n    content_new_order:[],\r\n    shuffled_content:[],\r\n    shuffled_arrays:{},\r\n  }\r\n\r\n  this_survey_html += \"<tr>\";\r\n  for(i = 0; i < this_survey.length; i++){\r\n    this_row = this_survey[i];\r\n    row_html = process_survey_question(this_row,i);\r\n    this_survey_object.content.push(row_html[0]);\r\n    this_survey_object.shuffle.push(row_html[1]);\r\n\t}\r\n\r\n\tunique_shuffles = this_survey_object.shuffle.filter((v,i,a)=>a.indexOf(v)==i); //by Camilo Martin on https://stackoverflow.com/questions/1960473/unique-values-in-an-array\r\n\r\n\tfor(var i=0;i<unique_shuffles.length;i++){\r\n    if(typeof(unique_shuffles[i]) !== \"undefined\" &&\r\n      unique_shuffles[i] !== \"none\" &&\r\n      unique_shuffles[i] !== \"\"){\r\n        shuffled_content = this_survey_object.shuffle.map(function(element,index){\r\n    \t   if(typeof(element)!== \"undefined\" && element.toLowerCase() !== \"none\" && element.toLowerCase() == unique_shuffles[i]){\r\n  \t       return this_survey_object.content[index];\r\n    \t   }\r\n    \t}).filter(elm => typeof(elm) !== \"undefined\");\r\n    \tnew_order = shuffle(shuffled_content);\r\n    \tthis_survey_object.shuffled_arrays[unique_shuffles[i]]=new_order; // add new array with dynamic name\r\n    }\r\n\t}\r\n\r\n\t// loop through lists, taking one off from the shuffled list and replacing the row with one from the shuffled list\r\n\tfor(var i=0;i<this_survey_object.content.length;i++){\r\n    var this_index = Object.keys(this_survey_object.shuffled_arrays).indexOf(this_survey_object.shuffle[i]);\r\n    if(this_index !== -1){\r\n      //take first item off relevant list and delete item\r\n      var this_item = this_survey_object.shuffled_arrays[Object.keys(this_survey_object.shuffled_arrays)[this_index]].shift();\r\n      this_survey_object.content_new_order[i]=this_item;\r\n    } else {\r\n      this_survey_object.content_new_order[i]=this_survey_object.content[i];\r\n    }\r\n\t}\r\n\r\n\tquestions_in_order = this_survey_object.content_new_order.join(\"</tr><tr>\");\r\n\tquestions_in_order += \"</tr>\";\r\n\r\n\tthis_survey_html += questions_in_order;\r\n\tthis_survey_html += \"</table>\";\r\n\r\n\t$(\"#\" + this_id).html(this_survey_html);\r\n\t$(\"#\" + this_id).show(1000);\r\n\r\n\t//scroll to top\r\n\r\n\r\n\t$(\".show_tab\").on(\"click\",function(){\r\n    if(this.className.indexOf(\"disabled\") == -1){\r\n      $(\".show_tab\").removeClass(\"active\");\r\n      $(\".survey_page\").hide();\r\n      $(\"#\"+this.id.replace(\"_button\",\"\")).show();\r\n    } else {\r\n      bootbox.alert(\"You have not yet unlocked this tab - maybe try clicking on <b>Proceed</b>?\");\r\n    }\r\n\t});\r\n  $('[data-toggle=\"tooltip\"]').tooltip();\r\n  $(\".custom-checkbox\").prop(\"indeterminate\",true);\r\n}\r\n\r\n//////////////////\r\n// Load survey  //\r\n//////////////////\r\ncurrent_survey = \"{{survey}}\";\r\nif(typeof(Trial) !== \"undefined\"){  // This check is to help this code work when previewing trialtypes\r\n  Trial.set_timer(function(){       // This chunk is for when the survey is run within an actual trial\r\n    load_survey(current_survey);\r\n  },100);\r\n} else {                            // This chunk is for when the survey is being previewed in the \"survey editor\"\r\n  load_survey(current_survey);\r\n}\r\n\r\n\r\n</script>"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "Stimuli.csv", "procedure": "Procedure.csv", "fullscreen": "off", "welcome": "", "participant_id": "random", "end_message": "", "start_message": "", "buffer": "5", "download_at_end": "off", "": ""}, {"name": "", "notes": ""}], "python_procs": {"procedure.csv": "item,trial type,max time,text,shuffle 1,survey,\r\n0,instruct,user,Thank you for participating in this experiment.,off,\t,\r\n2,instruct,user,Thank you for participating in this experiment.,off,\t,\r\n2 to 9,finger_imitation,user,,trials,,\r\n0,survey,user,,off,demographics_py2rm_2020.csv,\r\n,,,,,,"}, "python_stims": {"stimuli.csv": "Cue,Answer,face,emotion,gender,identity,\r\nA,Apple,AF01ANS.JPG,angry,female,1,\r\nB,Banana,AF01HAS.JPG,happy,female,1,\r\n,,AF02ANS.JPG,angry,female,2,\r\n,,AF02HAS.JPG,happy,female,2,\r\n,,AF03ANS.JPG,angry,female,3,\r\n,,AF03HAS.JPG,happy,female,3,\r\n,,AF04ANS.JPG,angry,female,4,\r\n,,AF04HAS.JPG,happy,female,4,\r\n,,AF05ANS.JPG,angry,female,5,\r\n,,AF05HAS.JPG,happy,female,5,\r\n,,AF06ANS.JPG,angry,female,6,\r\n,,AF06HAS.JPG,happy,female,6,\r\n,,AF07ANS.JPG,angry,female,7,\r\n,,AF07HAS.JPG,happy,female,7,\r\n,,AF08ANS.JPG,angry,female,8,\r\n,,AF08HAS.JPG,happy,female,8,\r\n,,AF09ANS.JPG,angry,female,9,\r\n,,AF09HAS.JPG,happy,female,9,\r\n,,AF10ANS.JPG,angry,female,10,\r\n,,AF10HAS.JPG,happy,female,10,\r\n,,AF11ANS.JPG,angry,female,11,\r\n,,AF11HAS.JPG,happy,female,11,\r\n,,AF12ANS.JPG,angry,female,12,\r\n,,AF12HAS.JPG,happy,female,12,\r\n,,AF13ANS.JPG,angry,female,13,\r\n,,AF13HAS.JPG,happy,female,13,\r\n,,AF14ANS.JPG,angry,female,14,\r\n,,AF14HAS.JPG,happy,female,14,\r\n,,AF15ANS.JPG,angry,female,15,\r\n,,AF15HAS.JPG,happy,female,15,\r\n,,AF16ANS.JPG,angry,female,16,\r\n,,AF16HAS.JPG,happy,female,16,\r\n,,AF17ANS.JPG,angry,female,17,\r\n,,AF17HAS.JPG,happy,female,17,\r\n,,AF18ANS.JPG,angry,female,18,\r\n,,AF18HAS.JPG,happy,female,18,\r\n,,AF19ANS.JPG,angry,female,19,\r\n,,AF19HAS.JPG,happy,female,19,\r\n,,AF20ANS.JPG,angry,female,20,\r\n,,AF20HAS.JPG,happy,female,20,\r\n,,AF21ANS.JPG,angry,female,21,\r\n,,AF21HAS.JPG,happy,female,21,\r\n,,AF22ANS.JPG,angry,female,22,\r\n,,AF22HAS.JPG,happy,female,22,\r\n,,AF23ANS.JPG,angry,female,23,\r\n,,AF23HAS.JPG,happy,female,23,\r\n,,AF24ANS.JPG,angry,female,24,\r\n,,AF24HAS.JPG,happy,female,24,\r\n,,AF25ANS.JPG,angry,female,25,\r\n,,AF25HAS.JPG,happy,female,25,\r\n,,AF26ANS.JPG,angry,female,26,\r\n,,AF26HAS.JPG,happy,female,26,\r\n,,AF27ANS.JPG,angry,female,27,\r\n,,AF27HAS.JPG,happy,female,27,\r\n,,AF28ANS.JPG,angry,female,28,\r\n,,AF28HAS.JPG,happy,female,28,\r\n,,AF29ANS.JPG,angry,female,29,\r\n,,AF29HAS.JPG,happy,female,29,\r\n,,AF30ANS.JPG,angry,female,30,\r\n,,AF30HAS.JPG,happy,female,30,\r\n,,AF31ANS.JPG,angry,female,31,\r\n,,AF31HAS.JPG,happy,female,31,\r\n,,AF32ANS.JPG,angry,female,32,\r\n,,AF32HAS.JPG,happy,female,32,\r\n,,AF33ANS.JPG,angry,female,33,\r\n,,AF33HAS.JPG,happy,female,33,\r\n,,AF34ANS.JPG,angry,female,34,\r\n,,AF34HAS.JPG,happy,female,34,\r\n,,AF35ANS.JPG,angry,female,35,\r\n,,AF35HAS.JPG,happy,female,35,\r\n,,AN01ANS.JPG,angry,male,1,\r\n,,AN01HAS.JPG,happy,male,1,\r\n,,AN02ANS.JPG,angry,male,2,\r\n,,AN02HAS.JPG,happy,male,2,\r\n,,AN03ANS.JPG,angry,male,3,\r\n,,AN03HAS.JPG,happy,male,3,\r\n,,AN04ANS.JPG,angry,male,4,\r\n,,AN04HAS.JPG,happy,male,4,\r\n,,AN05ANS.JPG,angry,male,5,\r\n,,AN05HAS.JPG,happy,male,5,\r\n,,AN06ANS.JPG,angry,male,6,\r\n,,AN06HAS.JPG,happy,male,6,\r\n,,AN07ANS.JPG,angry,male,7,\r\n,,AN07HAS.JPG,happy,male,7,\r\n,,AN08ANS.JPG,angry,male,8,\r\n,,AN08HAS.JPG,happy,male,8,\r\n,,AN09ANS.JPG,angry,male,9,\r\n,,AN09HAS.JPG,happy,male,9,\r\n,,AN10ANS.JPG,angry,male,10,\r\n,,AN10HAS.JPG,happy,male,10,\r\n,,AN11ANS.JPG,angry,male,11,\r\n,,AN11HAS.JPG,happy,male,11,\r\n,,AN12ANS.JPG,angry,male,12,\r\n,,AN12HAS.JPG,happy,male,12,\r\n,,AN13ANS.JPG,angry,male,13,\r\n,,AN13HAS.JPG,happy,male,13,\r\n,,AN14ANS.JPG,angry,male,14,\r\n,,AN14HAS.JPG,happy,male,14,\r\n,,AN15ANS.JPG,angry,male,15,\r\n,,AN15HAS.JPG,happy,male,15,\r\n,,AN16ANS.JPG,angry,male,16,\r\n,,AN16HAS.JPG,happy,male,16,\r\n,,AN17ANS.JPG,angry,male,17,\r\n,,AN17HAS.JPG,happy,male,17,\r\n,,AN18ANS.JPG,angry,male,18,\r\n,,AN18HAS.JPG,happy,male,18,\r\n,,AN19ANS.JPG,angry,male,19,\r\n,,AN19HAS.JPG,happy,male,19,\r\n,,AN20ANS.JPG,angry,male,20,\r\n,,AN20HAS.JPG,happy,male,20,\r\n,,AN21ANS.JPG,angry,male,21,\r\n,,AN21HAS.JPG,happy,male,21,\r\n,,AN22ANS.JPG,angry,male,22,\r\n,,AN22HAS.JPG,happy,male,22,\r\n,,AN23ANS.JPG,angry,male,23,\r\n,,AN23HAS.JPG,happy,male,23,\r\n,,AN24ANS.JPG,angry,male,24,\r\n,,AN24HAS.JPG,happy,male,24,\r\n,,AN25ANS.JPG,angry,male,25,\r\n,,AN25HAS.JPG,happy,male,25,\r\n,,AN26ANS.JPG,angry,male,26,\r\n,,AN26HAS.JPG,happy,male,26,\r\n,,AN27ANS.JPG,angry,male,27,\r\n,,AN27HAS.JPG,happy,male,27,\r\n,,AN28ANS.JPG,angry,male,28,\r\n,,AN28HAS.JPG,happy,male,28,\r\n,,AN29ANS.JPG,angry,male,29,\r\n,,AN29HAS.JPG,happy,male,29,\r\n,,AN30ANS.JPG,angry,male,30,\r\n,,AN30HAS.JPG,happy,male,30,\r\n,,AN31ANS.JPG,angry,male,31,\r\n,,AN31HAS.JPG,happy,male,31,\r\n,,AN32ANS.JPG,angry,male,32,\r\n,,AN32HAS.JPG,happy,male,32,\r\n,,AN33ANS.JPG,angry,male,33,\r\n,,AN33HAS.JPG,happy,male,33,\r\n,,AN34ANS.JPG,angry,male,34,\r\n,,AN34HAS.JPG,happy,male,34,\r\n,,AN35ANS.JPG,angry,male,35,\r\n,,AN35HAS.JPG,happy,male,35,\r\n,,,,,,"}, "python_conditions": "Name,Notes,Stimuli,Procedure,fullscreen,welcome,participant_id,end_message,start_message,buffer,download_at_end,\r\ncondition_1,You can put more detailed notes in this field,Stimuli.csv,Procedure.csv,off,,random,,,5,off,\r\n,", "boosts": {}}, "starttest": {"all_procs": {"Procedure.csv": [["Item", "Trial Type", "Max Time", "Text", "Shuffle 1", null], ["0", "Instruct", "user", "This is the start of a new experiment.", "off", null], [null, null, null, null, null, null]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", null], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "", "on", "", "", 5, null], [null, null, null, null, null, null, null, null, null, null, null]], "Conditions.csv": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv"]], "all_stims": {"Stimuli.csv": [["Cue", "Answer", null], ["A", "Apple", null], ["B", "Banana", null], [null, null, null]]}, "procedure": null, "stimuli": null, "public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"Procedure.csv": [{"": "", "item": "0", "trial type": "Instruct", "max time": "user", "text": "This is the start of a new experiment.", "shuffle 1": "off"}, {"": "", "item": "", "trial type": "", "max time": "", "text": "", "shuffle 1": ""}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "Stimuli.csv", "procedure": "Procedure.csv", "fullscreen": "off", "welcome": "", "participant_id": "on", "end_message": "", "start_message": "", "buffer": "5", "": ""}]}, "brap": {"all_procs": {"Procedure.csv": [["Item", "Trial Type", "Max Time", "Text", "Shuffle 1", null], ["0", "Instruct", "user", "This is the start of a new experiment.", "off", null], [null, null, null, null, null, null]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", null], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "", "on", "", "", 5, null], [null, null, null, null, null, null, null, null, null, null, null]], "Conditions.csv": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv"]], "all_stims": {"Stimuli.csv": [["Cue", "Answer", null], ["A", "Apple", null], ["B", "Banana", null], [null, null, null]]}, "procedure": null, "stimuli": null, "public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"Procedure.csv": [{"": "", "item": "0", "trial type": "instruct", "max time": "user", "text": "This is the start of a new experiment.", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>"}}, "brop": {"all_procs": {"Procedure.csv": [["Item", "Trial Type", "Max Time", "Text", "Shuffle 1", ""], ["2", "Instruct", "user", "This is the start of a new experiment.", "off", ""], ["", "", "", "", "", ""]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", "download_at_end", ""], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "bas", "random", "", "", "5", "off", ""], ["", ""]], "Conditions.csv": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv"]], "all_stims": {"Stimuli.csv": [["Cue", "Answer", ""], ["A", "Apple", ""], ["B", "Banana", ""], ["", "", ""]]}, "procedure": null, "stimuli": null, "public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"Procedure.csv": [{"": "", "item": "2", "trial type": "instruct", "max time": "user", "text": "This is the start of a new experiment.", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "Stimuli.csv", "procedure": "Procedure.csv", "fullscreen": "off", "welcome": "bas", "participant_id": "random", "end_message": "", "start_message": "", "buffer": "5", "download_at_end": "off", "": ""}, {"name": "", "notes": ""}], "python_procs": {"Procedure.csv": "Item,Trial Type,Max Time,Text,Shuffle 1,\r\n2,Instruct,user,This is the start of a new experiment.,off,\r\n,,,,,"}, "python_conditions": "Name,Notes,Stimuli,Procedure,fullscreen,welcome,participant_id,end_message,start_message,buffer,download_at_end,\r\ncondition_1,You can put more detailed notes in this field,Stimuli.csv,Procedure.csv,off,bas,random,,,5,off,\r\n,", "python_stims": {"Stimuli.csv": "Cue,Answer,\r\nA,Apple,\r\nB,Banana,\r\n,,"}}, "burp": {"all_procs": {"Procedure_1": [["Item", "Trial Type", "Max Time", "Text", "Shuffle 1", ""], ["2", "Instruct", "user", "This is the start of a new experiment.", "off", ""], ["", "", "", "", "", ""]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", "download_at_end", ""], ["condition_1", "You can put more detailed notes in this field", "Stimuli.csv", "Procedure.csv", "off", "beep", "random", "", "", "5", "off", ""], ["", ""]], "Conditions": [["Name", "Notes", "Stimuli 1", "Procedure 1"], ["New Experiment", "You can put more detailed notes in this field", "Stimuli_1", "Procedure_1"]], "all_stims": {"Stimuli_1": [["Cue", "Answer", ""], ["A", "Apple", ""], ["B", "Banana", ""], ["", "", ""]]}, "procedure": "Procedure_1", "stimuli": "Stimuli_1", "public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "Stimuli.csv", "procedure": "Procedure.csv", "fullscreen": "off", "welcome": "beep", "participant_id": "random", "end_message": "", "start_message": "", "buffer": "5", "download_at_end": "off", "": ""}, {"name": "", "notes": ""}], "parsed_procs": {"Procedure_1": [{"": "", "item": "2", "trial type": "instruct", "max time": "user", "text": "This is the start of a new experiment.", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>"}, "python_procs": {"Procedure_1": "Item,Trial Type,Max Time,Text,Shuffle 1,\r\n2,Instruct,user,This is the start of a new experiment.,off,\r\n,,,,,"}, "python_stims": {"Stimuli_1": "Cue,Answer,\r\nA,Apple,\r\nB,Banana,\r\n,,"}, "python_conditions": "Name,Notes,Stimuli,Procedure,fullscreen,welcome,participant_id,end_message,start_message,buffer,download_at_end,\r\ncondition_1,You can put more detailed notes in this field,Stimuli.csv,Procedure.csv,off,beep,random,,,5,off,\r\n,"}, "class_vote_student": {"all_procs": {"procedure_1.csv": [["Item", "trial type", "Max Time", "Text", "Shuffle 1", ""], ["2", "class_vote_student", "user", "Thank you for participating in this experiment. The task will begin during the next trial.", "off", ""], ["", "", "", "", "", ""]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", ""], ["condition_1", "You can put more detailed notes in this field", "stimuli_1.csv", "procedure_1.csv", "off", "", "random", "", "", "5", ""], ["", "", "", "", "", "", "", "", "", "", ""]], "all_stims": {"stimuli_1.csv": [["Cue", "Answer", "question_id", "script_url", "response_id", ""], ["A", "ginger", "1_45I8VIvnHwR3gvDyizZO9pY9lZv-lLQH6MWk3QTnhg", "https://script.google.com/macros/s/AKfycbz3KSAcuF_6Gg6-25l2a22dNSeMvo5agjPHB467BceyUbzJOfry/exec", "1XOsZuX2-_fSIDnveJSBoIHbpSXnYpoM7N9QQ8HO4ctA", ""], ["B", "Banana", "", "", "", ""], ["", "", "", "", "", ""]]}, "procedure": null, "stimuli": null, "public_key": "qbLtY/WKogexV2MtzKeCjHng8DKNjOOmIfEnpj1Z90A=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"procedure_1.csv": [{"trial type": "class_vote_student", "": "", "item": "2", "max time": "user", "text": "Thank you for participating in this experiment. The task will begin during the next trial.", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>", "class_vote_student": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\nThis makes heavy use of amcharts - available at https://www.amcharts.com/\r\n\r\n-->\r\n<style>\r\n.submit_response_btn{\r\n  width:100%;\r\n}\r\n#response_table{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:300;\r\n  height:300;\r\n  display:none;\r\n}\r\n#start_quiz_btn{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:100;\r\n  height:50;\r\n}\r\n</style>\r\n<button class=\"btn btn-primary\" id=\"start_quiz_btn\">Start</button>\r\n<div id=\"response_table\"></div>\r\n\r\n\r\n<!-- Chart code -->\r\n<script>\r\n\r\n//wrap the below into a tidy object at some point.\r\n\r\nvar participant_code = makeid(10);\r\nvar question_no      = -1;\r\n\r\n\r\ndata = {\r\n  question_id: \"{{question_id}}\",\r\n  response_id: \"{{response_id}}\",\r\n  action:      \"start_student\",\r\n  participant_code: participant_code\r\n};\r\n  \r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet\r\n    refresh_question();\r\n  });\r\n});\r\n\r\nfunction refresh_question(){\r\n  ParseGSX.parseGSX(data.question_id,function(result){\r\n    show_question(result);\r\n    setTimeout(function(){\r\n      refresh_question();\r\n    },2000);\r\n  });\r\n}\r\n\r\n\r\nfunction show_question(result){\r\n  //identify current row\r\n  question_no = 0;\r\n  result.forEach(function(row,row_index){\r\n    if(row.complete == \"yes\"){\r\n      question_no = row_index + 1;\r\n    }\r\n  });\r\n  var this_row         = result[question_no];\r\n  var question         = this_row.question;\r\n  var responses        = this_row.responses.split(\"|\");\r\n  var correct_response = this_row.correct_response;\r\n  \r\n  var response_table_html = \"<table>\" + \r\n                              \"<tr>\" +\r\n                                \"<td><h4>\" + question + \"</h4><br><br></td>\" + \r\n                              \"</tr>\";\r\n  responses.forEach(function(response){\r\n    response_table_html += \"<tr><td><button class='btn btn-primary submit_response_btn'>\" + response + \"</button></td></tr>\";\r\n  });                  \r\n  response_table_html += \"</table>\";\r\n                              \r\n  $(\"#response_table\").html(response_table_html);\r\n  $(\".submit_response_btn\").on(\"click\",function(){\r\n    submit_response(this.innerHTML);\r\n  });\r\n  $(\"#response_table\").show();\r\n  $(\"#start_quiz_btn\").hide();\r\n}\r\n\r\nfunction submit_response(response){\r\n  console.dir(question_no);\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      \"vote\",\r\n    question_no: question_no,\r\n    participant_code: participant_code,\r\n    response: response\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(result){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    /*\r\n    ParseGSX.parseGSX(data.question_id,function(result){\r\n      show_question(result);\r\n    });\r\n    */\r\n  });\r\n}\r\n\r\nresponse_obj = {\r\n  question_no : -1,\r\n  responses   : []\r\n}\r\n\r\n\r\n\r\n\r\n    \r\nvar ParseGSX = (function() {\r\n\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.ajax(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n\r\n  return { parseGSX: parseGSX };\r\n\r\n})();\r\n\r\n\r\n//based on solution by csharptest.net at https://stackoverflow.com/questions/1349404/generate-random-string-characters-in-javascript\r\nfunction makeid(length) {\r\n   var result           = '';\r\n   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmonpqrstuvwxyz1234567890';\r\n   var charactersLength = characters.length;\r\n   for ( var i = 0; i < length; i++ ) {\r\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n   }\r\n   return result;\r\n}\r\n\r\n\r\n</script>", "class_vote_teacher": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\n-->\r\n<style>\r\n#before_start{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:300;\r\n}\r\n#chartdiv {\r\n  width: 100%;\r\n  height: 600px;\r\n}\r\n#header_reveal_table td{\r\n  padding:10px;\r\n}\r\n#hide_results{\r\n  display:none;\r\n}\r\n.text_resp_div{\r\n  padding:10px;\r\n  margin:10px;\r\n  width:100%;\r\n}\r\n#trial_contents{\r\n  display:none;\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:600;\r\n}\r\n\r\n</style>\r\n<div id=\"before_start\">\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"start_quiz_btn\">Start</button>\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"resume_quiz_btn\">Resume</button>\r\n</div>\r\n<div id=\"trial_contents\">\r\n  <table id=\"header_reveal_table\">\r\n    <tr>\r\n      <td colspan=\"3\">  \r\n        <h1 id=\"question_header\"></h1>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <!--\r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"show_results\">Reveal</button>    \r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"hide_results\">Hide</button>    \r\n        -->\r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-danger\" id=\"previous_question_btn\">Previous</button>    \r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-success\" id=\"next_question_btn\">Next</button>    \r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <div id=\"output_div\"></div>\r\n</div>\r\n\r\n<!-- libraries -->\r\n<script src = \"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js\"></script>\r\n\r\n<!-- local script -->\r\n<script>\r\n\r\noutput_contents = {\r\n  current : \"\",\r\n  list: [],\r\n  js_charts: {}\r\n}\r\n\r\nvar quest_no = 0;\r\n\r\n\r\n// actions by class\r\n$(\".hide_reveal_results\").on(\"click\",function(){\r\n  \r\n  $(\".hide_reveal_results\").hide();\r\n  // show is \"Reveal\" clicked\r\n  if(this.innerHTML == \"Reveal\"){\r\n    $(\"#hide_results\").show();\r\n    $(\"#output_div\").fadeIn(100);\r\n  } else {\r\n  //hide if \"hide\" clicked\r\n    $(\"#show_results\").show();\r\n    $(\"#output_div\").hide();\r\n  }\r\n});\r\n\r\n\r\n\r\n//actions by id: start, next, previous then end\r\n///////////////////////////////////////////////\r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  quest_no = 0;\r\n  post_action(\"start\",function(){\r\n    $(\"#previous_question_btn\").hide(); //by definition cannot need this\r\n    \r\n    //if there's more than one question, then need to see next button.\r\n    //if(quest_array.length > 1){\r\n      $(\"#next_question_btn\").show(); //by definition must need this\r\n    //}\r\n    \r\n    $(\"#before_start\").hide();\r\n    $(\"#trial_contents\").show();\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#next_question_btn\").on(\"click\",function(){\r\n  post_action(\"next\",function(){\r\n    console.dir(\"next clicked\");\r\n    $(\"#previous_question_btn\").show(); //by definition must see this\r\n    quest_no++;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    $(\"#next_question_btn\").show(); //by definition must see this\r\n    quest_no--;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n/* end quiz button\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    ParseGSX.parseGSX(data.response_id,function(result){\r\n      response_obj = result;\r\n      generate_chart();\r\n    });\r\n  });\r\n});\r\n*/\r\n\r\n\r\n\r\n//functions alphabetically\r\n//////////////////////////\r\n\r\nfunction calculate_chart_data(response_obj,local_quest_no){\r\n                                \r\n  local_quest_no = local_quest_no + 1;\r\n                                \r\n  var this_q_resps = response_obj.map(function(row){\r\n    return row[\"q\" + local_quest_no + \"resp\"];\r\n  });\r\n  //identify the frequencies of each unique value\r\n  var counts = {};\r\n  //by typeof at https://stackoverflow.com/questions/5667888/counting-the-occurrences-frequency-of-array-elements\r\n  for (var i = 0; i < this_q_resps.length; i++) {\r\n    var response = this_q_resps[i];\r\n    counts[response] = counts[response] ? counts[response] + 1 : 1;\r\n  }\r\n  return counts;\r\n}\r\n\r\nfunction choice_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  //chartdiv\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<canvas class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></canvas>');\r\n    canvas = document.getElementById(output_id);\r\n    ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    \r\n    output_contents.js_charts[output_id] = new Chart(ctx, {\r\n      type: 'horizontalBar',\r\n      data: {\r\n        labels: all_resps,\r\n        datasets: [{\r\n          label: '# of Votes',\r\n          data: data_values,\r\n          backgroundColor: back_color_array,\r\n          borderColor: bord_color_array,\r\n          borderWidth: 1\r\n        }]\r\n      },\r\n      options: {\r\n        legend: {\r\n          display: false\r\n        },\r\n        scales: {\r\n          xAxes: [{\r\n            ticks: {\r\n              beginAtZero: true,\r\n              fontSize: 20\r\n            }\r\n          }],\r\n          yAxes: [{\r\n            ticks: {\r\n              fontSize: 20\r\n            }\r\n          }]\r\n        }\r\n      }\r\n    });\r\n    output_contents.list.push(output_id);\r\n    \r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction text_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  var unique_resps = list_resps(response_obj,local_quest_no);\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<div class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></div>');\r\n\r\n    var output_html = \"\";\r\n    unique_resps.forEach(function(this_resp){\r\n      output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n    }); \r\n    \r\n    $(\"#\" + output_id).html(output_html);\r\n    output_contents.list.push(output_id);\r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction generate_chart(local_quest_no){\r\n  ParseGSX.parseGSX(data.question_id,function(quest_array){\r\n    ParseGSX.parseGSX(data.response_id,function(response_obj){\r\n    \r\n      $(\"#question_header\").html(quest_array[local_quest_no].question);\r\n      \r\n      var quest_type = quest_array[local_quest_no].type;\r\n      \r\n      switch(quest_type.toLowerCase()){\r\n        case \"choice\":\r\n        case \"multiple choice\":\r\n        case \"multiple_choice\":\r\n          choice_question(quest_array,\r\n                          response_obj,\r\n                          local_quest_no);\r\n          break;\r\n        case \"text\":\r\n          text_question(quest_array,\r\n                        response_obj,\r\n                        local_quest_no);\r\n          break;\r\n\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction list_resps(response_obj,this_quest_no){\r\n  this_quest_no = this_quest_no + 1;\r\n  \r\n  var quest_key = \"q\" + this_quest_no + \"resp\";\r\n  var unique_resps = [];\r\n  response_obj.forEach(function(row){\r\n    if(unique_resps.indexOf(row[quest_key]) == -1){\r\n      unique_resps.push(row[quest_key]);\r\n    }\r\n  });\r\n  return unique_resps;\r\n}\r\n\r\n\r\nfunction post_action(action,response){\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      action\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    response();\r\n  });\r\n}\r\n\r\nfunction refresh_output(local_quest_no){\r\n  \r\n  console.dir(\"local_quest_no\");\r\n  console.dir(local_quest_no);\r\n  \r\n  var output_id = 'output' + local_quest_no;\r\n  \r\n  var url = \"https://spreadsheets.google.com/feeds/list/{{response_id}}/od6/public/values?alt=json\";\r\n  $.get(url,function(res){\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    \r\n    var chartCount = calculate_chart_data(finalData,\r\n                                      local_quest_no);\r\n    \r\n\r\n    \r\n    //identify what type of question it is!\r\n      //identify what the class of the visible output_content is\r\n    var element_type = $(\".output_content:visible\")[0].tagName.toLowerCase();\r\n    \r\n    switch(element_type){\r\n      case \"canvas\":\r\n      var labels = output_contents.js_charts[output_id].data.labels;\r\n      \r\n      var data_values = labels.map(function(key){\r\n        if(typeof(chartCount[key]) !== \"undefined\"){\r\n          return chartCount[key];\r\n        } else {\r\n          return 0;\r\n        }\r\n      });\r\n      \r\n      output_contents.js_charts[output_id].data.datasets[0].data = data_values;\r\n      output_contents.js_charts[output_id].update();        \r\n        break;\r\n        \r\n      case \"div\":\r\n        var unique_resps = list_resps(finalData,local_quest_no);\r\n        \r\n        var output_html = \"\";\r\n        unique_resps.forEach(function(this_resp){\r\n          output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n        }); \r\n        \r\n        $(\"#\" + output_id).html(output_html);\r\n        break;\r\n    }\r\n\r\n    \r\n    setTimeout(function(){\r\n      refresh_output(local_quest_no);\r\n    },1000);  \r\n  });\r\n  \r\n  /*\r\n  if (callback) { _defaultCallback = callback; }\r\n  $.when(ajax).then(_parseRawData);\r\n  */\r\n  \r\n}\r\n\r\nfunction resps_values(quest_array, response_obj, local_quest_no){\r\n  \r\n  console.dir(quest_array);\r\n  console.dir(JSON.stringify(quest_array));\r\n  \r\n                        \r\n  chartCount        = calculate_chart_data(response_obj,\r\n                                           local_quest_no);\r\n                                           \r\n  var all_resps     = quest_array[local_quest_no].responses.split(\"|\");\r\n  var correct       = quest_array[local_quest_no].correct;\r\n  var correct_index = all_resps.indexOf(correct);\r\n  \r\n  var correct_color = 'rgba(75, 192, 192,'; //  0.8)';\r\n  var wrong_color   = 'rgba(255, 99, 132,'; //  0.8)';\r\n  var neutral_color = 'rgba(54, 162, 235,'; //  0.8)';\r\n  \r\n  //colors if there is no correct answer\r\n  if(correct_index == -1){\r\n    back_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 0.8)\";\r\n    });\r\n    bord_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 1)\";\r\n    });\r\n  } else {\r\n    back_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 0.8)\";\r\n      } else {\r\n        return wrong_color + \" 0.8)\";  \r\n      }\r\n    });\r\n    bord_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 1)\";\r\n      } else {\r\n        return wrong_color + \" 1)\";\r\n      }\r\n    });\r\n  }\r\n  \r\n  var data_values = all_resps.map(function(key){\r\n    if(typeof(chartCount[key]) !== \"undefined\"){\r\n      return chartCount[key];\r\n    } else {\r\n      return 0;\r\n    }\r\n  });\r\n  \r\n  return [all_resps,\r\n          data_values,\r\n          back_color_array,\r\n          bord_color_array];\r\n}\r\n\r\n//Code from online sources\r\n//////////////////////////\r\n\r\n//based on code found at: https://raw.githubusercontent.com/drumwolf/parse-gsx/0ba67bf115eac96e0763777a4fb2c485a35e2daa/parse-gsx-ajax.js\r\nvar ParseGSX = (function() {\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.get(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n  return { parseGSX: parseGSX };\r\n})();\r\n\r\n</script>"}, "python_procs": {"procedure_1.csv": "Item,trial type,Max Time,Text,Shuffle 1,\r\n2,class_vote_student,user,Thank you for participating in this experiment. The task will begin during the next trial.,off,\r\n,,,,,"}, "python_conditions": "Name,Notes,Stimuli,Procedure,fullscreen,welcome,participant_id,end_message,start_message,buffer,\r\ncondition_1,You can put more detailed notes in this field,stimuli_1.csv,procedure_1.csv,off,,random,,,5,\r\n,,,,,,,,,,", "python_stims": {"stimuli_1.csv": "Cue,Answer,question_id,script_url,response_id,\r\nA,ginger,1_45I8VIvnHwR3gvDyizZO9pY9lZv-lLQH6MWk3QTnhg,https://script.google.com/macros/s/AKfycbz3KSAcuF_6Gg6-25l2a22dNSeMvo5agjPHB467BceyUbzJOfry/exec,1XOsZuX2-_fSIDnveJSBoIHbpSXnYpoM7N9QQ8HO4ctA,\r\nB,Banana,,,,\r\n,,,,,"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "stimuli_1.csv", "procedure": "procedure_1.csv", "fullscreen": "off", "welcome": "", "participant_id": "random", "end_message": "", "start_message": "", "buffer": "5", "": ""}]}, "class_vote_teacher": {"all_procs": {"procedure_1.csv": [["Item", "trial type", "Max Time", "Text", "Shuffle 1", ""], ["2", "class_vote_student", "user", "Thank you for participating in this experiment. The task will begin during the next trial.", "off", ""], ["", "", "", "", "", ""]]}, "cond_array": [["Name", "Notes", "Stimuli", "Procedure", "fullscreen", "welcome", "participant_id", "end_message", "start_message", "buffer", ""], ["condition_1", "You can put more detailed notes in this field", "stimuli_1.csv", "procedure_1.csv", "off", "", "random", "", "", "5", ""], ["", "", "", "", "", "", "", "", "", "", ""]], "all_stims": {"stimuli_1.csv": [["Cue", "Answer", "question_id", "script_url", "response_id", ""], ["A", "ginger", "1_45I8VIvnHwR3gvDyizZO9pY9lZv-lLQH6MWk3QTnhg", "https://script.google.com/macros/s/AKfycbz3KSAcuF_6Gg6-25l2a22dNSeMvo5agjPHB467BceyUbzJOfry/exec", "1XOsZuX2-_fSIDnveJSBoIHbpSXnYpoM7N9QQ8HO4ctA", ""], ["B", "Banana", "", "", "", ""], ["", "", "", "", "", ""]]}, "procedure": null, "stimuli": null, "public_key": "qbLtY/WKogexV2MtzKeCjHng8DKNjOOmIfEnpj1Z90A=", "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec", "parsed_procs": {"procedure_1.csv": [{"trial type": "class_vote_student", "": "", "item": "2", "max time": "user", "text": "Thank you for participating in this experiment. The task will begin during the next trial.", "shuffle 1": "off"}]}, "surveys": {}, "trialtypes": {"instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>", "class_vote_student": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\nThis makes heavy use of amcharts - available at https://www.amcharts.com/\r\n\r\n-->\r\n<style>\r\n.submit_response_btn{\r\n  width:100%;\r\n}\r\n#response_table{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:300;\r\n  height:300;\r\n  display:none;\r\n}\r\n#start_quiz_btn{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:100;\r\n  height:50;\r\n}\r\n</style>\r\n<button class=\"btn btn-primary\" id=\"start_quiz_btn\">Start</button>\r\n<div id=\"response_table\"></div>\r\n\r\n\r\n<!-- Chart code -->\r\n<script>\r\n\r\n//wrap the below into a tidy object at some point.\r\n\r\nvar participant_code = makeid(10);\r\nvar question_no      = -1;\r\n\r\n\r\ndata = {\r\n  question_id: \"{{question_id}}\",\r\n  response_id: \"{{response_id}}\",\r\n  action:      \"start_student\",\r\n  participant_code: participant_code\r\n};\r\n  \r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet\r\n    refresh_question();\r\n  });\r\n});\r\n\r\nfunction refresh_question(){\r\n  ParseGSX.parseGSX(data.question_id,function(result){\r\n    show_question(result);\r\n    setTimeout(function(){\r\n      refresh_question();\r\n    },2000);\r\n  });\r\n}\r\n\r\n\r\nfunction show_question(result){\r\n  //identify current row\r\n  question_no = 0;\r\n  result.forEach(function(row,row_index){\r\n    if(row.complete == \"yes\"){\r\n      question_no = row_index + 1;\r\n    }\r\n  });\r\n  var this_row         = result[question_no];\r\n  var question         = this_row.question;\r\n  var responses        = this_row.responses.split(\"|\");\r\n  var correct_response = this_row.correct_response;\r\n  \r\n  var response_table_html = \"<table>\" + \r\n                              \"<tr>\" +\r\n                                \"<td><h4>\" + question + \"</h4><br><br></td>\" + \r\n                              \"</tr>\";\r\n  responses.forEach(function(response){\r\n    response_table_html += \"<tr><td><button class='btn btn-primary submit_response_btn'>\" + response + \"</button></td></tr>\";\r\n  });                  \r\n  response_table_html += \"</table>\";\r\n                              \r\n  $(\"#response_table\").html(response_table_html);\r\n  $(\".submit_response_btn\").on(\"click\",function(){\r\n    submit_response(this.innerHTML);\r\n  });\r\n  $(\"#response_table\").show();\r\n  $(\"#start_quiz_btn\").hide();\r\n}\r\n\r\nfunction submit_response(response){\r\n  console.dir(question_no);\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      \"vote\",\r\n    question_no: question_no,\r\n    participant_code: participant_code,\r\n    response: response\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(result){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    /*\r\n    ParseGSX.parseGSX(data.question_id,function(result){\r\n      show_question(result);\r\n    });\r\n    */\r\n  });\r\n}\r\n\r\nresponse_obj = {\r\n  question_no : -1,\r\n  responses   : []\r\n}\r\n\r\n\r\n\r\n\r\n    \r\nvar ParseGSX = (function() {\r\n\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.ajax(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n\r\n  return { parseGSX: parseGSX };\r\n\r\n})();\r\n\r\n\r\n//based on solution by csharptest.net at https://stackoverflow.com/questions/1349404/generate-random-string-characters-in-javascript\r\nfunction makeid(length) {\r\n   var result           = '';\r\n   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmonpqrstuvwxyz1234567890';\r\n   var charactersLength = characters.length;\r\n   for ( var i = 0; i < length; i++ ) {\r\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n   }\r\n   return result;\r\n}\r\n\r\n\r\n</script>", "class_vote_teacher": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\n-->\r\n<style>\r\n#before_start{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:300;\r\n}\r\n#chartdiv {\r\n  width: 100%;\r\n  height: 600px;\r\n}\r\n#header_reveal_table td{\r\n  padding:10px;\r\n}\r\n#hide_results{\r\n  display:none;\r\n}\r\n.text_resp_div{\r\n  padding:10px;\r\n  margin:10px;\r\n  width:100%;\r\n}\r\n#trial_contents{\r\n  display:none;\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:600;\r\n}\r\n\r\n</style>\r\n<div id=\"before_start\">\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"start_quiz_btn\">Start</button>\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"resume_quiz_btn\">Resume</button>\r\n</div>\r\n<div id=\"trial_contents\">\r\n  <table id=\"header_reveal_table\">\r\n    <tr>\r\n      <td colspan=\"3\">  \r\n        <h1 id=\"question_header\"></h1>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <!--\r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"show_results\">Reveal</button>    \r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"hide_results\">Hide</button>    \r\n        -->\r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-danger\" id=\"previous_question_btn\">Previous</button>    \r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-success\" id=\"next_question_btn\">Next</button>    \r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <div id=\"output_div\"></div>\r\n</div>\r\n\r\n<!-- libraries -->\r\n<script src = \"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js\"></script>\r\n\r\n<!-- local script -->\r\n<script>\r\n\r\noutput_contents = {\r\n  current : \"\",\r\n  list: [],\r\n  js_charts: {}\r\n}\r\n\r\nvar quest_no = 0;\r\n\r\n\r\n// actions by class\r\n$(\".hide_reveal_results\").on(\"click\",function(){\r\n  \r\n  $(\".hide_reveal_results\").hide();\r\n  // show is \"Reveal\" clicked\r\n  if(this.innerHTML == \"Reveal\"){\r\n    $(\"#hide_results\").show();\r\n    $(\"#output_div\").fadeIn(100);\r\n  } else {\r\n  //hide if \"hide\" clicked\r\n    $(\"#show_results\").show();\r\n    $(\"#output_div\").hide();\r\n  }\r\n});\r\n\r\n\r\n\r\n//actions by id: start, next, previous then end\r\n///////////////////////////////////////////////\r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  quest_no = 0;\r\n  post_action(\"start\",function(){\r\n    $(\"#previous_question_btn\").hide(); //by definition cannot need this\r\n    \r\n    //if there's more than one question, then need to see next button.\r\n    //if(quest_array.length > 1){\r\n      $(\"#next_question_btn\").show(); //by definition must need this\r\n    //}\r\n    \r\n    $(\"#before_start\").hide();\r\n    $(\"#trial_contents\").show();\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#next_question_btn\").on(\"click\",function(){\r\n  post_action(\"next\",function(){\r\n    console.dir(\"next clicked\");\r\n    $(\"#previous_question_btn\").show(); //by definition must see this\r\n    quest_no++;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    $(\"#next_question_btn\").show(); //by definition must see this\r\n    quest_no--;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n/* end quiz button\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    ParseGSX.parseGSX(data.response_id,function(result){\r\n      response_obj = result;\r\n      generate_chart();\r\n    });\r\n  });\r\n});\r\n*/\r\n\r\n\r\n\r\n//functions alphabetically\r\n//////////////////////////\r\n\r\nfunction calculate_chart_data(response_obj,local_quest_no){\r\n                                \r\n  local_quest_no = local_quest_no + 1;\r\n                                \r\n  var this_q_resps = response_obj.map(function(row){\r\n    return row[\"q\" + local_quest_no + \"resp\"];\r\n  });\r\n  //identify the frequencies of each unique value\r\n  var counts = {};\r\n  //by typeof at https://stackoverflow.com/questions/5667888/counting-the-occurrences-frequency-of-array-elements\r\n  for (var i = 0; i < this_q_resps.length; i++) {\r\n    var response = this_q_resps[i];\r\n    counts[response] = counts[response] ? counts[response] + 1 : 1;\r\n  }\r\n  return counts;\r\n}\r\n\r\nfunction choice_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  //chartdiv\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<canvas class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></canvas>');\r\n    canvas = document.getElementById(output_id);\r\n    ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    \r\n    output_contents.js_charts[output_id] = new Chart(ctx, {\r\n      type: 'horizontalBar',\r\n      data: {\r\n        labels: all_resps,\r\n        datasets: [{\r\n          label: '# of Votes',\r\n          data: data_values,\r\n          backgroundColor: back_color_array,\r\n          borderColor: bord_color_array,\r\n          borderWidth: 1\r\n        }]\r\n      },\r\n      options: {\r\n        legend: {\r\n          display: false\r\n        },\r\n        scales: {\r\n          xAxes: [{\r\n            ticks: {\r\n              beginAtZero: true,\r\n              fontSize: 20\r\n            }\r\n          }],\r\n          yAxes: [{\r\n            ticks: {\r\n              fontSize: 20\r\n            }\r\n          }]\r\n        }\r\n      }\r\n    });\r\n    output_contents.list.push(output_id);\r\n    \r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction text_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  var unique_resps = list_resps(response_obj,local_quest_no);\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<div class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></div>');\r\n\r\n    var output_html = \"\";\r\n    unique_resps.forEach(function(this_resp){\r\n      output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n    }); \r\n    \r\n    $(\"#\" + output_id).html(output_html);\r\n    output_contents.list.push(output_id);\r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction generate_chart(local_quest_no){\r\n  ParseGSX.parseGSX(data.question_id,function(quest_array){\r\n    ParseGSX.parseGSX(data.response_id,function(response_obj){\r\n    \r\n      $(\"#question_header\").html(quest_array[local_quest_no].question);\r\n      \r\n      var quest_type = quest_array[local_quest_no].type;\r\n      \r\n      switch(quest_type.toLowerCase()){\r\n        case \"choice\":\r\n        case \"multiple choice\":\r\n        case \"multiple_choice\":\r\n          choice_question(quest_array,\r\n                          response_obj,\r\n                          local_quest_no);\r\n          break;\r\n        case \"text\":\r\n          text_question(quest_array,\r\n                        response_obj,\r\n                        local_quest_no);\r\n          break;\r\n\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction list_resps(response_obj,this_quest_no){\r\n  this_quest_no = this_quest_no + 1;\r\n  \r\n  var quest_key = \"q\" + this_quest_no + \"resp\";\r\n  var unique_resps = [];\r\n  response_obj.forEach(function(row){\r\n    if(unique_resps.indexOf(row[quest_key]) == -1){\r\n      unique_resps.push(row[quest_key]);\r\n    }\r\n  });\r\n  return unique_resps;\r\n}\r\n\r\n\r\nfunction post_action(action,response){\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      action\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    response();\r\n  });\r\n}\r\n\r\nfunction refresh_output(local_quest_no){\r\n  \r\n  console.dir(\"local_quest_no\");\r\n  console.dir(local_quest_no);\r\n  \r\n  var output_id = 'output' + local_quest_no;\r\n  \r\n  var url = \"https://spreadsheets.google.com/feeds/list/{{response_id}}/od6/public/values?alt=json\";\r\n  $.get(url,function(res){\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    \r\n    var chartCount = calculate_chart_data(finalData,\r\n                                      local_quest_no);\r\n    \r\n\r\n    \r\n    //identify what type of question it is!\r\n      //identify what the class of the visible output_content is\r\n    var element_type = $(\".output_content:visible\")[0].tagName.toLowerCase();\r\n    \r\n    switch(element_type){\r\n      case \"canvas\":\r\n      var labels = output_contents.js_charts[output_id].data.labels;\r\n      \r\n      var data_values = labels.map(function(key){\r\n        if(typeof(chartCount[key]) !== \"undefined\"){\r\n          return chartCount[key];\r\n        } else {\r\n          return 0;\r\n        }\r\n      });\r\n      \r\n      output_contents.js_charts[output_id].data.datasets[0].data = data_values;\r\n      output_contents.js_charts[output_id].update();        \r\n        break;\r\n        \r\n      case \"div\":\r\n        var unique_resps = list_resps(finalData,local_quest_no);\r\n        \r\n        var output_html = \"\";\r\n        unique_resps.forEach(function(this_resp){\r\n          output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n        }); \r\n        \r\n        $(\"#\" + output_id).html(output_html);\r\n        break;\r\n    }\r\n\r\n    \r\n    setTimeout(function(){\r\n      refresh_output(local_quest_no);\r\n    },1000);  \r\n  });\r\n  \r\n  /*\r\n  if (callback) { _defaultCallback = callback; }\r\n  $.when(ajax).then(_parseRawData);\r\n  */\r\n  \r\n}\r\n\r\nfunction resps_values(quest_array, response_obj, local_quest_no){\r\n  \r\n  console.dir(quest_array);\r\n  console.dir(JSON.stringify(quest_array));\r\n  \r\n                        \r\n  chartCount        = calculate_chart_data(response_obj,\r\n                                           local_quest_no);\r\n                                           \r\n  var all_resps     = quest_array[local_quest_no].responses.split(\"|\");\r\n  var correct       = quest_array[local_quest_no].correct;\r\n  var correct_index = all_resps.indexOf(correct);\r\n  \r\n  var correct_color = 'rgba(75, 192, 192,'; //  0.8)';\r\n  var wrong_color   = 'rgba(255, 99, 132,'; //  0.8)';\r\n  var neutral_color = 'rgba(54, 162, 235,'; //  0.8)';\r\n  \r\n  //colors if there is no correct answer\r\n  if(correct_index == -1){\r\n    back_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 0.8)\";\r\n    });\r\n    bord_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 1)\";\r\n    });\r\n  } else {\r\n    back_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 0.8)\";\r\n      } else {\r\n        return wrong_color + \" 0.8)\";  \r\n      }\r\n    });\r\n    bord_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 1)\";\r\n      } else {\r\n        return wrong_color + \" 1)\";\r\n      }\r\n    });\r\n  }\r\n  \r\n  var data_values = all_resps.map(function(key){\r\n    if(typeof(chartCount[key]) !== \"undefined\"){\r\n      return chartCount[key];\r\n    } else {\r\n      return 0;\r\n    }\r\n  });\r\n  \r\n  return [all_resps,\r\n          data_values,\r\n          back_color_array,\r\n          bord_color_array];\r\n}\r\n\r\n//Code from online sources\r\n//////////////////////////\r\n\r\n//based on code found at: https://raw.githubusercontent.com/drumwolf/parse-gsx/0ba67bf115eac96e0763777a4fb2c485a35e2daa/parse-gsx-ajax.js\r\nvar ParseGSX = (function() {\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.get(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n  return { parseGSX: parseGSX };\r\n})();\r\n\r\n</script>"}, "python_procs": {"procedure_1.csv": "Item,trial type,Max Time,Text,Shuffle 1,\r\n2,class_vote_student,user,Thank you for participating in this experiment. The task will begin during the next trial.,off,\r\n,,,,,"}, "python_conditions": "Name,Notes,Stimuli,Procedure,fullscreen,welcome,participant_id,end_message,start_message,buffer,\r\ncondition_1,You can put more detailed notes in this field,stimuli_1.csv,procedure_1.csv,off,,random,,,5,\r\n,,,,,,,,,,", "python_stims": {"stimuli_1.csv": "Cue,Answer,question_id,script_url,response_id,\r\nA,ginger,1_45I8VIvnHwR3gvDyizZO9pY9lZv-lLQH6MWk3QTnhg,https://script.google.com/macros/s/AKfycbz3KSAcuF_6Gg6-25l2a22dNSeMvo5agjPHB467BceyUbzJOfry/exec,1XOsZuX2-_fSIDnveJSBoIHbpSXnYpoM7N9QQ8HO4ctA,\r\nB,Banana,,,,\r\n,,,,,"}, "conditions": [{"name": "condition_1", "notes": "You can put more detailed notes in this field", "stimuli": "stimuli_1.csv", "procedure": "procedure_1.csv", "fullscreen": "off", "welcome": "", "participant_id": "random", "end_message": "", "start_message": "", "buffer": "5", "": ""}]}}, "incomp_process": false, "pipe_position": 0, "pipe_direction": "", "versions": [], "exp_condition": null}, "surveys": {"default_surveys": {"empathy_quotient_40.csv": [["item_name", "text", "Type", "Answers", "Values", "Score: EQ_Test", "Score: Cognitive", "Score: Social_Skills", "Score: Emotional_Reactivity", "optional"], ["Instructions1", "Choose one response that best describes how strongly each item applies to you:", "Instruct", "", "", "", "", "", "", ""], ["EQ1", "I can easily tell if someone else wants to enter a conversation.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ4", "I find it difficult to explain to others things that I understand easily, when they don\u2019t understand it the first time.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "r1", "", "no"], ["EQ6", "I really enjoy caring for other people.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "1", "no"], ["EQ8", "I find it hard to know what to do in a social situation.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "r1", "", "no"], ["EQ10", "People often tell me that I went too far in driving my point home in a discussion.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ11", "It doesn\u2019t bother me too much if I am late meeting a friend.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ12", "Friendships and relationships are just too difficult, so I tend not to bother with them.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "r1", "", "no"], ["EQ14", "I often find it difficult to judge if something is rude or polite.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "r1", "", "no"], ["EQ15", "In a conversation, I tend to focus on my own thoughts rather than on what my listener might be thinking.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ18", "When I was a child, I enjoyed cutting up worms to see what would happen.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ19", "I can pick up quickly if someone says one thing but means another.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ21", "It is hard for me to see why some things upset people so much.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ22", "I find it easy to put myself in somebody else\u2019s shoes.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "1", "no"], ["EQ25", "I am good at predicting how someone will feel.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ26", "I am quick to spot when someone in a group is feeling awkward or uncomfortable.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ27", "If I say something that someone else is offended by, I think that that\u2019s their problem, not mine.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ28", "If anyone asked me if I liked their haircut, I would reply truthfully, even if I didn\u2019t like it.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ29", "I can\u2019t always see why someone should have felt offended by a remark.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ32", "Seeing people cry doesn\u2019t really upset me.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ34", "I am very blunt, which some people take to be rudeness, even though this is unintentional.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ35", "I do not tend to find social situations confusing.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "1", "", "no"], ["EQ36", "Other people tell me I am good at understanding how they are feeling and what they are thinking.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ37", "When I talk to people, I tend to talk about their experiences rather than my own.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "", "no"], ["EQ38", "It upsets me to see an animal in pain.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "", "no"], ["EQ39", "I am able to make decisions without being influenced by people\u2019s feelings.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ41", "I can easily tell if someone else is interested or bored with what I am saying.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ42", "I get upset if I see people suffering on news programs.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "1", "no"], ["EQ43", "Friends usually talk to me about their problems as they say that I am very understanding.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "1", "no"], ["EQ44", "I can sense if I am intruding, even if the other person doesn\u2019t tell me.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ46", "People sometimes tell me that I have gone too far with teasing.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ48", "Other people often say that I am insensitive, though I don\u2019t always see why.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ49", "If I see a stranger in a group, I think that it is up to them to make an effort to join in.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "", "no"], ["EQ50", "I usually stay emotionally detached when watching a film.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "r1", "", "", "r1", "no"], ["EQ52", "I can tune into how someone else feels rapidly and intuitively.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ54", "I can easily work out what another person might want to talk about.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ55", "I can tell if someone is masking their true emotion.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ57", "I don\u2019t consciously work out the rules of social situations.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "1", "", "no"], ["EQ58", "I am good at predicting what someone will do.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "1", "", "", "no"], ["EQ59", "I tend to get emotionally involved with a friend\u2019s problems.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "1", "no"], ["EQ60", "I can usually appreciate the other person\u2019s viewpoint, even if I don\u2019t agree with it.", "likert", "Strongly agree|Slightly agree|Slightly disagree|Strongly disagree", "2|1|0|0", "1", "", "", "", "no"], [""]], "demographics.csv": [["item_name", "text", "Type", "Answers", "Optional", "Values"], ["Gender", "Gender", "likert", "Male|Female|Other", "No", ""], ["Age", "Age", "Number", "", "No", ""], ["Education", "Education (which level are you currently in, or is the highest you've completed)", "Dropdown", "Some high school| High school graduate| Some college, no degree| Associate's degree| Bachelor's degree|Graduate degree (Master's, Doctorate, etc.)", "No", ""], ["English_Fluency", "Do you speak English fluently?", "likert", "Yes|No", "No", ""], ["English_Age", "At what age did you start learning English? (write \"0\" if from birth)", "Number", "", "No", ""], ["Country", "What is your country of residence?", "Text", "", "No", ""], ["Handedness", "What is your preferred hand?", "Likert", "Left|Right|Both", "No", ""], ["ethnicity", "If you would like to please state your ethnicity", "Dropdown", "Caucasian|Asian|Hispanic|African|Other", "Yes", ""], [""]], "autism_quotient.csv": [["item_name", "text", "Type", "Answers", "Values", "Score: AQ_Test", "Score: Social_Skill", "Score: Attention_switching", "Score: Communication", "Score: Imagination", "Score: Attention_to_detail", "Optional"], ["Instructions1", "Choose one response that best describes how strongly each item applies to you:", "Instruct", "", "", "", "", "", "", "", "", ""], ["AQ1", "I prefer to do things with others rather than on my own.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ2", "I prefer to do things the same way over and over again.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No"], ["AQ3", "If I try to imagine something, I find it very easy to create a picture in my mind.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], ["AQ4", "I frequently get so strongly absorbed in one thing that I lose sight of other things.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No"], ["AQ5", "I often notice small sounds when others do not.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ6", "I usually notice car number plates or similar strings of information.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ7", "Other people frequently tell me that what I\u2019ve said is impolite, even though I think it is polite.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ8", "When I\u2019m reading a story, I can easily imagine what the characters might look like.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], ["AQ9", "I am fascinated by dates.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ10", "In a social group, I can easily keep track of several different people\u2019s conversations.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No"], ["AQ11", "I find social situations easy.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ12", "I tend to notice details that others do not.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ13", "I would rather go to a library than a party.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No"], ["AQ14", "I find making up stories easy.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], ["AQ15", "I find myself drawn more strongly to people than to things.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ16", "I tend to have very strong interests which I get upset about if I can\u2019t pursue.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No"], ["AQ17", "I enjoy social chit-chat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No"], ["AQ18", "When I talk, it isn\u2019t always easy for others to get a word in edgeways.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ19", "I am fascinated by numbers.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ20", "When I\u2019m reading a story, I find it difficult to work out the characters\u2019 intentions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No"], ["AQ21", "I don\u2019t particularly enjoy reading fiction.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No"], ["AQ22", "I find it hard to make new friends.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No"], ["AQ23", "I notice patterns in things all the time.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No"], ["AQ24", "I would rather go to the theatre than a museum.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], ["AQ25", "It does not upset me if my daily routine is disturbed.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No"], ["AQ26", "I frequently find that I don\u2019t know how to keep a conversation going.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ27", "I find it easy to \u201cread between the lines\u201d when someone is talking to me.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No"], ["AQ28", "I usually concentrate more on the whole picture, rather than the small details.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No"], ["AQ29", "I am not very good at remembering phone numbers.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No"], ["AQ30", "I don\u2019t usually notice small changes in a situation, or a person\u2019s appearance.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No"], ["AQ31", "I know how to tell if someone listening to me is getting bored.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No"], ["AQ32", "I find it easy to do more than one thing at once.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No"], ["AQ33", "When I talk on the phone, I\u2019m not sure when it\u2019s my turn to speak.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ34", "I enjoy doing things spontaneously.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No"], ["AQ35", "I am often the last to understand the point of a joke.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ36", "I find it easy to work out what someone is thinking or feeling just by looking at their face.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ37", "If there is an interruption, I can switch back to what I was doing very quickly.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No"], ["AQ38", "I am good at social chit-chat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No"], ["AQ39", "People often tell me that I keep going on and on about the same thing.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No"], ["AQ40", "When I was young, I used to enjoy playing games involving pretending with other children.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], ["AQ41", "I like to collect information about categories of things (e.g. types of car, types of bird, types of train, types of plant, etc.).", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No"], ["AQ42", "I find it difficult to imagine what it would be like to be someone else.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No"], ["AQ43", "I like to plan any activities I participate in carefully.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No"], ["AQ44", "I enjoy social occasions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ45", "I find it difficult to work out people\u2019s intentions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No"], ["AQ46", "New situations make me anxious.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No"], ["AQ47", "I enjoy meeting new people.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ48", "I am a good diplomat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No"], ["AQ49", "I am not very good at remembering people\u2019s date of birth.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No"], ["AQ50", "I find it very easy to play games with children that involve pretending.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No"], [""]]}, "user_surveys": {"brep": [["item_name", "text", "Type", "Answers", "Values", "Score: AQ_Test", "Score: Social_Skill", "Score: Attention_switching", "Score: Communication", "Score: Imagination", "Score: Attention_to_detail", "Optional", null], ["Instructions1", "Choose one response that best describes how strongly each item applies to you:", "Instruct", "", "", "", "", "", "", "", "", "", null], ["AQ1", "Beep bop", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ2", "I prefer to do things the same way over and over again.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No", null], ["AQ3", "If I try to imagine something, I find it very easy to create a picture in my mind.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["AQ4", "I frequently get so strongly absorbed in one thing that I lose sight of other things.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No", null], ["AQ5", "I often notice small sounds when others do not.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ6", "I usually notice car number plates or similar strings of information.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ7", "Other people frequently tell me that what I\u2019ve said is impolite, even though I think it is polite.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ8", "When I\u2019m reading a story, I can easily imagine what the characters might look like.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["AQ9", "I am fascinated by dates.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ10", "In a social group, I can easily keep track of several different people\u2019s conversations.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No", null], ["AQ11", "I find social situations easy.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ12", "I tend to notice details that others do not.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ13", "I would rather go to a library than a party.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No", null], ["AQ14", "I find making up stories easy.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["AQ15", "I find myself drawn more strongly to people than to things.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ16", "I tend to have very strong interests which I get upset about if I can\u2019t pursue.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No", null], ["AQ17", "I enjoy social chit-chat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No", null], ["AQ18", "When I talk, it isn\u2019t always easy for others to get a word in edgeways.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ19", "I am fascinated by numbers.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ20", "When I\u2019m reading a story, I find it difficult to work out the characters\u2019 intentions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No", null], ["AQ21", "I don\u2019t particularly enjoy reading fiction.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No", null], ["AQ22", "I find it hard to make new friends.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No", null], ["AQ23", "I notice patterns in things all the time.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "", "1", "No", null], ["AQ24", "I would rather go to the theatre than a museum.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["AQ25", "It does not upset me if my daily routine is disturbed.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No", null], ["AQ26", "I frequently find that I don\u2019t know how to keep a conversation going.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ27", "I find it easy to \u201cread between the lines\u201d when someone is talking to me.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No", null], ["AQ28", "I usually concentrate more on the whole picture, rather than the small details.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No", null], ["AQ29", "I am not very good at remembering phone numbers.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No", null], ["AQ30", "I don\u2019t usually notice small changes in a situation, or a person\u2019s appearance.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No", null], ["AQ31", "I know how to tell if someone listening to me is getting bored.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No", null], ["AQ32", "I find it easy to do more than one thing at once.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No", null], ["AQ33", "When I talk on the phone, I\u2019m not sure when it\u2019s my turn to speak.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ34", "I enjoy doing things spontaneously.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No", null], ["AQ35", "I am often the last to understand the point of a joke.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ36", "I find it easy to work out what someone is thinking or feeling just by looking at their face.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ37", "If there is an interruption, I can switch back to what I was doing very quickly.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "r1", "", "", "", "No", null], ["AQ38", "I am good at social chit-chat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "r1", "", "", "No", null], ["AQ39", "People often tell me that I keep going on and on about the same thing.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "1", "", "", "No", null], ["AQ40", "When I was young, I used to enjoy playing games involving pretending with other children.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["AQ41", "I like to collect information about categories of things (e.g. types of car, types of bird, types of train, types of plant, etc.).", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No", null], ["AQ42", "I find it difficult to imagine what it would be like to be someone else.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "", "", "1", "", "No", null], ["AQ43", "I like to plan any activities I participate in carefully.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No", null], ["AQ44", "I enjoy social occasions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ45", "I find it difficult to work out people\u2019s intentions.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "1", "", "", "", "", "No", null], ["AQ46", "New situations make me anxious.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "1", "", "1", "", "", "", "No", null], ["AQ47", "I enjoy meeting new people.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ48", "I am a good diplomat.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "r1", "", "", "", "", "No", null], ["AQ49", "I am not very good at remembering people\u2019s date of birth.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "", "r1", "No", null], ["AQ50", "I find it very easy to play games with children that involve pretending.", "likert", "Definitely agree|Slightly agree|Slightly disagree|Definitely disagree", "1|1|0|0", "r1", "", "", "", "r1", "", "No", null], ["", null]], "demographics_py2rm_2020": [["item_name", "text", "Type", "Answers", "Optional", "Values", null], ["Gender", "Gender", "likert", "Male|Female|Other", "No", "", null], ["Age", "Age", "Number", "", "No", "", null], ["Education", "Education (which level are you currently in, or is the highest you've completed)", "Dropdown", "Some high school| High school graduate| Some college, no degree| Associate's degree| Bachelor's degree|Graduate degree (Master's, Doctorate, etc.)", "No", "", null], ["English_Fluency", "Do you speak English fluently?", "likert", "Yes|No", "No", "", null], ["English_Age", "At what age did you start learning English? (write \"0\" if from birth)", "Number", "", "No", "", null], ["Country", "What is your country of residence?", "Text", "", "No", "", null], ["Handedness", "What is your preferred hand?", "Likert", "Left|Right|Both", "No", "", null], ["ethnicity", "If you would like to please state your ethnicity", "Dropdown", "Caucasian|East Asian|South Asian|African|Other", "Yes", "", null], ["", null]]}, "preview": true}, "trialtypes": {"default_trialtypes": {"survey": "<!--\r\n  Author: Dr. Anthony Haffey\r\n\r\n  Collector: Cat/Kitten release\r\n  A program for running experiments on the web\r\n  Copyright 2012-2018 Mikey Garcia & Nate Kornell\r\n\r\n\r\n  This program is free software: you can redistribute it and/or modify\r\n  it under the terms of the GNU General Public License version 3 as published by\r\n  the Free Software Foundation.\r\n\r\n  This program is distributed in the hope that it will be useful,\r\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n  GNU General Public License for more details.\r\n\r\n  You should have received a copy of the GNU General Public License\r\n  along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n\r\n  Kitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\r\n-->\r\n<style>\r\ntd{\r\n  padding:10px;\r\n  vertical-align: top;\r\n}\r\n#content{\r\n  width:95%;\r\n}\r\n#proceed_button{\r\n  display:none;\r\n  float:right;\r\n}\r\n#this_survey_id{\r\n  padding:            20px;\r\n  display:            none;\r\n}\r\n#survey_outline{\r\n  background-color:   white;\r\n  color:              #0a3272;\r\n  border-radius:      20px;\r\n}\r\n#survey_tabs{\r\n  padding:            20px;\r\n}\r\n\r\n.btn-primary{\r\n\tcolor:#fff;\r\n\tbackground-color:#069;\r\n\tborder-color:#069;\r\n}\r\n.btn-primary:hover,\r\n.btn-primary:focus {\r\n  background-color: #09c;\r\n}\r\n\r\n.btn-primary:focus {\r\n  outline: 0;\r\n}\r\n\r\n.btn-primary:active {\r\n  background-color:#0f9;\r\n}\r\n.feedback_span_multiple{\r\n  display:none;\r\n  margin :10px;\r\n}\r\n.feedback_span_single{\r\n  display:none;\r\n  padding:10px;\r\n}\r\n.likert_table td{\r\n  padding:1px;\r\n  text-align:center;\r\n}\r\n.likert_table td:hover{\r\n  color:blue;\r\n}\r\n.score_total{\r\n  display:none;\r\n}\r\n.show_tab{\r\n  margin:5px;\r\n}\r\n.table_break{\r\n  width:100%;\r\n}\r\n</style>\r\n<div id=\"survey_outline\"></div>\r\n<script>\r\n/////////////////////////\r\n// Retrieving settings //\r\n/////////////////////////\r\n\r\nif(typeof(settings) !== \"undefined\"){\r\n  settings = [settings];\r\n} else {\r\n  settings = {};\r\n}\r\n\r\n//////////////////////////////////\r\n// vertical vs. horizontal tabs //\r\n//////////////////////////////////\r\n\r\nif(typeof(settings.tab_hor_vert) == \"undefined\" || settings.tab_hor_vert.toLowerCase() == \"horizontal\"){\r\n  settings.tab_hor_vert = \"horizontal\";\r\n  $(\"#survey_outline\").html(  '<div id=\"please_wait_div\">Loading... Please wait</div>'+\r\n                              '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>'+\r\n                              '<div id=\"survey_tabs\" style=\"text-align:right\" class=\"border-top border-primary\"></div><input type=\"submit\" value=\"Proceed\" class=\"btn btn-primary\" id=\"proceed_button\">');\r\n\r\n} else if (settings.tab_hor_vert.toLowerCase() == \"vertical\"){\r\n  $(\"#survey_outline\").html( '<table>'+\r\n                                '<tr>'+\r\n                                  '<td valign=\"top\" class=\"border-right border-primary\">'+\r\n                                    '<div id=\"survey_tabs\"></div></td>' +\r\n                                  '<td>'+\r\n                                    '<div id=\"please_wait_div\">Please wait while survey is downloading</div>'+\r\n                                    '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>' +\r\n                                    '<input type=\"button\" value=\"Proceed\" class=\"btn btn-primary\" id=\"proceed_button\">'+\r\n                                  '</td>'+\r\n                                '</tr>'+\r\n                              '</table>');\r\n} else if(settings.tab_hor_vert.toLowerCase() == \"none\"){\r\n  $(\"#survey_outline\").html(  '<div id=\"survey_tabs\" style=\"display:none\"></div>' +\r\n                              '<div id=\"please_wait_div\">Please wait while survey is downloading</div>'+\r\n                              '<div id=\"this_survey_id\" class=\"needs-validation\" novalidate></div>');\r\n} else {\r\n  bootbox.alert(\"If you are the researcher, please check the 'settings for this survey. The input for 'tab_hor_vert' appears to be invalid. Please change it to 'horizontal' or 'vertical' or 'none' or remove 'tab_hot_vert' altogether from the settings, which will make the tabs invisible\");\r\n}\r\n</script>\r\n\r\n<span id=\"scales_span\"></span>\r\n\r\n<script>\r\n\r\nString.prototype.replaceAll = function(str1, str2, ignore) {\r\n  //by qwerty at https://stackoverflow.com/questions/2116558/fastest-method-to-replace-all-instances-of-a-character-in-a-string\r\n  return this.replace(new RegExp(str1.replace(/([\\/\\,\\!\\\\\\^\\$\\{\\}\\[\\]\\(\\)\\.\\*\\+\\?\\|\\<\\>\\-\\&])/g,\"\\\\$&\"),(ignore?\"gi\":\"g\")),(typeof(str2)==\"string\")?str2.replace(/\\$/g,\"$$$$\"):str2);\r\n}\r\n\r\n\r\n//////////////////////\r\n// Defining objects //\r\n//////////////////////\r\n\r\npage_break_management = {\r\n  breaks_remaining : 0,\r\n  breaks_index     : 0\r\n}\r\n\r\nproceed_object = {\r\n  type:[],\r\n  name:[],\r\n  break_no:[]\r\n};\r\n\r\nscoring_object={\r\n  scales:[],\r\n  scale_scores:[],\r\n  update_scales:function(this_survey){\r\n    headers = Object.keys(this_survey[0]);\r\n    this.scales = headers.filter(elm => elm.includes(\"score:\"));\r\n    var scales_html = '';\r\n    this.scales.forEach(function(element){\r\n      element = element.replace(\": \",\":\");\r\n      scales_html += \"<input name='\"+element.replace(/ |:/g,\"_\")+\"' class='score_total \"+element.replace(/ |:/g,\"_\")+\"' disabled>\";\r\n    });\r\n    $(\"#scales_span\").html(scales_html);\r\n  }\r\n}\r\n\r\nsurvey_obj = {};\r\n\r\n\r\n/////////////////////\r\n// Element actions //\r\n/////////////////////\r\n\r\n/*\r\n$(function() {\r\n  $( \".datepicker\" ).datepicker({\r\n    dateFormat : 'mm/dd/yy',\r\n    changeMonth : true,\r\n    changeYear : true,\r\n    yearRange: '-100y:c+nn',\r\n    maxDate: '-1d'\r\n  });\r\n});\r\n*/\r\n\r\n\r\n$('#ExperimentContainer').css('transform','scale(1,1)');\r\n\r\n$(\"#proceed_button\").on(\"click\",function(){\r\n  var proceed = true;\r\n  var tabs    = document.getElementsByClassName('show_tab active');\r\n  if(tabs.length > 0){\r\n    var current_tab       = document.getElementsByClassName('show_tab active')[0].id.replace(\"_button\",\"\").replace(\"tab_\",\"\");\r\n    var response_elements = $('#table_'+current_tab).find('.response_element');\r\n\r\n  } else {\r\n    response_elements = $(\".table_break:visible\").find(\".response_element\");\r\n    //response_elements     = $('.response_element');\r\n  }\r\n\r\n  for(var i = 0; i < response_elements.length; i++){\r\n    [this_row_no,item_name] = retrieve_row_no_item_name(response_elements[i]);\r\n    var this_optional = survey_obj.data[this_row_no].optional.toLowerCase();\r\n\r\n    if(this_optional.indexOf(\"no\") !== -1){\r\n      this_optional = this_optional.split(\"-\");       // find out whether there's a minimal number of responses\r\n      if(this_optional.length == 1){                  // default is that length needs to be at least 1\r\n        var min_resp_length = 1;\r\n      } else if(this_optional.length == 2) {\r\n        var min_resp_length = this_optional[1];\r\n      } else {\r\n        bootbox.alert(\"Error - you appear to have too many '-' characters in the 'optional' column\");\r\n        return false;\r\n      }\r\n    } else {\r\n      min_resp_length = 0;\r\n    }\r\n\r\n    var quest_resp = isJSON($(\"#\"+response_elements[i].id).val());\r\n    if (quest_resp.length < min_resp_length){\r\n      proceed = false;\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).removeClass(\"text-success\");\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).addClass(\"text-danger\");\r\n    } else {\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).removeClass(\"text-danger\");\r\n      $(\"#\"+response_elements[i].id.replace(\"response\",\"question\")).addClass(\"text-success\");\r\n    }\r\n  }\r\n\r\n  if(current_tab == survey_obj.tabs && proceed){\r\n    if(typeof(sql_surveys) == \"undefined\"){\r\n      //$(\".table_break\");\r\n      console.dir('$(\".table_break:visible\")');\r\n      console.dir($(\".table_break:visible\"));\r\n      var next_table_no = parseFloat($(\".table_break:visible\")[0].id.replace(\"table\",\"\")) + 1;\r\n      console.dir(\"next_table_no\");\r\n      console.dir(next_table_no);\r\n      console.dir($(\".table_break#table_\"+next_table_no));\r\n\r\n      if($(\".table_break#table\"+next_table_no).length == 0){\r\n        if(typeof(Trial) !== \"undefined\"){\r\n          Trial.submit();\r\n        } else {\r\n          bootbox.alert(\"You've finished! Click on the preview button to restart.\")\r\n        }\r\n      } else {\r\n        $(\".table_break\").hide();\r\n        $(\".table_break#table\" + next_table_no).show();\r\n      }\r\n    } else {\r\n      $(\"#survey_outline\").html(\"<h1> You have finished the preview of this survey.</h1>\");\r\n    }\r\n  } else if(current_tab < survey_obj.tabs && proceed) {\r\n    current_tab ++;\r\n    $(\"#tab_\"+current_tab+\"_button\").removeClass(\"btn-secondary\");\r\n    $(\"#tab_\"+current_tab+\"_button\").removeClass(\"disabled\");\r\n    $(\"#tab_\"+current_tab+\"_button\").addClass(\"btn-outline-primary\");\r\n    $(\"#tab_\"+current_tab+\"_button\").click();\r\n  } else if(proceed == false){\r\n    bootbox.alert(\"You have failed to complete at least one compulsory input.\");\r\n  } else if(current_tab > survey_obj.tabs){\r\n    bootbox.alert(\"Error - please contact the Collector team about this problem, error 'Survey_001'.\");\r\n  }\r\n});\r\n\r\n\r\n///////////////\r\n// Functions //\r\n///////////////\r\n\r\n\r\nfunction load_survey(survey){\r\n  // are we in preview?\r\n  /////////////////////\r\n  console.dir(\"survey\");\r\n  console.dir(survey);\r\n  if(typeof(master_json) !== \"undefined\" && master_json.surveys.preview){     // Yes\r\n    survey_content = survey;                                                    // i.e. the content has been passed through directly\r\n    survey_obj.boosts = master_json.boosts;                                //no need to be efficient in preview\r\n\r\n  } else {                                                                      // No\r\n    survey = survey.toLowerCase().replace(\".csv\",\"\") + \".csv\";\r\n\r\n    if(typeof(parent.parent.exp_json.surveys) !== \"undefined\" && \r\n       typeof(parent.parent.exp_json.surveys[survey]) !== \"undefined\"){\r\n      survey_content = parent.parent.exp_json.surveys[survey];\r\n      survey_obj.boosts = parent.parent.exp_json.boosts;                     //take boosts from exp_json\r\n\r\n    } else {\r\n      bootbox.alert(\"Survey \" + survey  + \" doesn't appear to exist\");\r\n    }\r\n  }\r\n  process_returned_questionnaire(survey_content);\r\n}\r\n\r\nfunction generate_feedback_string(feedback_array,this_index,feedback_color,row_no,this_row){\r\n  if(feedback_array){                 //i.e. if it's not null\r\n    if(feedback_array.length > 1){\r\n      return \"<div class='feedback_span_multiple \"+this_row[\"item_name\"].toLowerCase()+\"_feedback' style='color:\"+feedback_color[this_index]+\"'>\"+feedback_array[this_index]+\"</div>\";\r\n    } else {\r\n      return \"<div class='feedback_span_single \"+this_row[\"item_name\"].toLowerCase()+\"_feedback' style='color:\"+feedback_color[this_index]+\"'>\"+feedback_array[this_index]+\"</div>\";\r\n    }\r\n  } else {\r\n    return \"\";\r\n  }\r\n}\r\n\r\nfunction isJSON(str) {\r\n  try {\r\n    return JSON.parse(str);\r\n  } catch (e) {\r\n    return str;\r\n  }\r\n}\r\n\r\n\r\nfunction likert_update(this_element,this_response,this_value){\r\n  [row_no,item_name] = retrieve_row_no_item_name(this_element);\r\n  $(\".row_\"+row_no).removeClass(\"active\");\r\n  $(\".row_\"+row_no).removeClass(\"btn-primary\");\r\n  $(\".row_\"+row_no).addClass(\"btn-outline-primary\");\r\n  $(this_element).removeClass(\"btn-outline-primary\");\r\n  $(this_element).addClass(\"btn-primary\");\r\n  $(\"#survey_\"+item_name+\"_response\").val(this_response);\r\n  response_check(this_element);\r\n}\r\n  console.dir(\"breaking near here? huh?\");\r\n\r\nfunction process_item_score(survey_obj,row_no,values_col,this_response,item,values_reverse){\r\n  console.dir(\"breaking near here?\");\r\n  item_values       = survey_obj.data[row_no][values_col].split(\"|\");\r\n  if(typeof(values_reverse) !== \"undefined\" && values_reverse == \"r\"){\r\n    item_values.reverse();\r\n  }\r\n  item_answers      = survey_obj.data[row_no][\"answers\"].split(\"|\");\r\n  var this_value    = item_values[item_answers.indexOf(this_response)];\r\n  $(\"#survey_\" + item + \"_score\").val(this_value);\r\n  if(typeof(this_value) !== \"undefined\"){\r\n    return parseFloat(this_value);\r\n  }\r\n}\r\n\r\nfunction process_returned_questionnaire(data){\r\n  survey_obj.data = data;\r\n  survey_obj.data = Papa.parse(Papa.unparse(survey_obj.data),{\r\n                      header:true,\r\n                      beforeFirstChunk: function(chunk) {\r\n                        var rows = chunk.split( /\\r\\n|\\r|\\n/ );\r\n                        var headings = rows[0].toLowerCase();\r\n                        rows[0] = headings;\r\n                        return rows.join(\"\\r\\n\");\r\n                      },\r\n                    }).data;\r\n\r\n  var col_headers = Object.keys(survey_obj.data[0]);\r\n  survey_obj.scales = {};\r\n\r\n  col_headers.forEach(function(header){\r\n    if(header.indexOf(\"score:\")==0){\r\n      var original_header = header;\r\n      header = header.replace(\"score: \",\"\");\r\n      header = header.replace(\"score:\",\"\");\r\n\r\n      survey_obj.scales[header] = {};\r\n      survey_obj.scales[header].questions = {};\r\n\r\n      //identify which questions\r\n      for(var i = 1; i< survey_obj.data.length; i++){\r\n        row = survey_obj.data[i];\r\n        if(row[original_header] !== \"\" && typeof(row[original_header]) !== \"undefined\"){\r\n          survey_obj.scales[header].questions[i] = row[original_header];\r\n        }\r\n      }\r\n    }\r\n  });\r\n  write_survey(survey_obj.data,\"this_survey_id\");\r\n  $(\"#please_wait_div\").hide();\r\n  $(\"#proceed_button\").show();\r\n\r\n  $('html, body').animate({\r\n    scrollTop: $(\"#survey_outline\").offset().top\r\n  }, 1000);\r\n}\r\n\r\nfunction process_survey_question(this_row,row_no){\r\n\r\n  if(this_row.values == \"\"){\r\n    this_row.values = this_row.answers;\r\n  }\r\n\r\n  if(typeof(this_row[\"text\"]) !== \"undefined\" && typeof(this_row[\"type\"]) !== \"undefined\" && this_row['text'].toLowerCase() == \"page_break\" | this_row['type'].toLowerCase() == \"page_break\"){\r\n        page_break_management.breaks_remaining++;\r\n        question_td = \"</tr></table><table id='table\"+page_break_management.breaks_remaining+\"' style='display:none' class='table_break'></tr>\";\r\n  } else {\r\n\r\n    if(typeof(this_row[\"values\"]) !== \"undefined\" & typeof(this_row[\"values\"]) !== \"function\"){ //to address microsoft edge issue.\r\n      value_array = this_row[\"values\"].split(\"|\");\r\n    } else {\r\n      value_array='';\r\n    }\r\n\r\n    if(this_row[\"item_name\"].indexOf(\" \") !== -1){\r\n      bootbox.alert(\"Please note that the 'item name' '\" + this_row['item_name'] + \"' is invalid because it has at least one space. Please use underscores instead of spaces. If you're not the creator of this task, please contact the person who created it.\");\r\n    }\r\n\r\n    // class for scoring\r\n    this_class = \"\";\r\n    for(var i=0;i<scoring_object.scales.length;i++){\r\n      if(this_row[scoring_object.scales[i].toLowerCase()]==\"1\"){\r\n        this_class += scoring_object.scales[i].toLowerCase().replace(\"score: \",\"\").replace(/ |-/,\"\")+\" \";\r\n      }\r\n      if(this_row[scoring_object.scales[i].toLowerCase()]==\"r1\"){\r\n        this_class += scoring_object.scales[i].toLowerCase().replace(\"score: \",\"\").replace(\" \",\"_\")+\"-r1 \";\r\n      }\r\n    }\r\n\r\n    [feedback_array,feedback_color] = retrieve_feedback(this_row);\r\n\r\n    response_html = '<input type=\"hidden\" class=\"response_element row_'+row_no+'\" id=\"survey_'+this_row[\"item_name\"].toLowerCase()+'_response\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'_response\"  value=\"\">';\r\n\r\n\r\n    // Survey settings\r\n    ////////////////////\r\n\r\n    [row_ques_perc,row_resp_perc] = quest_resp_perc(settings.quest_resp_rat);\r\n\r\n    if(typeof(settings.feedback_before_response) == \"undefined\"){\r\n        settings.feedback_before_response = true;\r\n    }\r\n\r\n    if(typeof(settings.lock_after_feedback) == \"undefined\"){\r\n        settings.lock_after_feedback = false;\r\n    }\r\n    var question_td='';\r\n\r\n    if(typeof(this_row[\"type\"]) == \"undefined\"){\r\n        return false;\r\n    }\r\n\r\n    // Item types\r\n    ///////////////\r\n\r\n    if(typeof(survey_obj.boosts) !== \"undefined\" && typeof(survey_obj.boosts[this_row.type]) !== \"undefined\"){\r\n\r\n      var boost_html = survey_obj.boosts[this_row.type].contents;\r\n      console.dir(boost_html);\r\n\r\n      //for each row variable, insert it into the boost if possible?\r\n      Object.keys(this_row).forEach(function(attribute){\r\n        console.dir(boost_html);\r\n        boost_html = boost_html.replaceAll(\"{{\"+attribute+\"}}\",this_row[attribute]);\r\n      });\r\n      question_td += boost_html;\r\n    } else {\r\n\r\n      switch(this_row[\"type\"].toLowerCase()){\r\n        case \"page_start\":\r\n          var tabs_html = $(\"#survey_tabs\").html();\r\n          if(settings.tab_hor_vert == \"horizontal\"){\r\n            span_div = \"span\";\r\n          } else if(settings.tab_hor_vert == \"vertical\"){\r\n            span_div = \"div\";\r\n          }\r\n          if(typeof(survey_obj.tabs) == \"undefined\"){\r\n            survey_obj.tabs = 0;\r\n          } else {\r\n            survey_obj.tabs++;\r\n          }\r\n          if(survey_obj.tabs == 0){ //i.e. is the first tab\r\n            active_button = \"btn-outline-primary active\";\r\n          } else {\r\n            active_button = \"btn-secondary disabled\";\r\n          }\r\n          if(settings.tab_hor_vert == \"vertical\"){\r\n            var vert_btn_block = \"btn-block\";\r\n          } else {\r\n            var vert_btn_block = \"\";\r\n          }\r\n\r\n          tabs_html +=  '<'+span_div+' class=\"btn-group-toggle\" data-toggle=\"buttons\">'+\r\n            '<label id=\"tab_' + survey_obj.tabs + '_button\" class=\"btn show_tab '+active_button+' '+vert_btn_block+'\">'+\r\n              '<input type=\"checkbox\" checked autocomplete=\"off\">'+ this_row['text'] +\r\n            '</label>'+\r\n          '</'+span_div+'>';\r\n\r\n          $(\"#survey_tabs\").html(tabs_html);\r\n\r\n          page_break_indexes = [];\r\n          survey_obj.data.forEach(function(this_row,this_index){\r\n            if(typeof(this_row.type) !== \"undefined\" && this_row.type.toLowerCase() == \"page_start\"){\r\n              page_break_indexes.push(this_index);\r\n            }\r\n          });\r\n\r\n          if(survey_obj.tabs>0){\r\n            question_td += \"</td><td></td></tr></table></div><div class='survey_page' id='tab_\"+survey_obj.tabs+\"' style='display:none'><table id='table_\"+survey_obj.tabs+\"' class='table_break'><tr>\";\r\n          } else {\r\n            question_td += \"</td><td></td></tr></table><div class='survey_page' id='tab_\"+survey_obj.tabs+\"' ><table id='table_\"+survey_obj.tabs+\"' class='table_break'><tr>\";\r\n          }\r\n        break;\r\n\r\n        case \"checkbox\":\r\n        case \"checkbox_vertical\":\r\n          var options = this_row[\"answers\"].split(\"|\");\r\n          question_td +=  response_html;\r\n          for(var i=0; i<options.length;i++){\r\n            feedback_string = generate_feedback_string(feedback_array,i,feedback_color,row_no,this_row);\r\n            question_td +=  '<div class=\"custom-control custom-checkbox\">'+\r\n                '<input type=\"checkbox\" class=\"custom-control-input '+this_class+' custom-control custom-checkbox '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                feedback_string +\r\n            '</div>';\r\n          }\r\n          break;\r\n\r\n          case \"checkbox_horizontal\":\r\n            feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n            var options = this_row[\"answers\"].split(\"|\");\r\n            question_td += response_html;\r\n            question_td += '<table><tr>';\r\n            for(var i=0; i<options.length;i++){\r\n              question_td +=  '<td>'+\r\n                                '<div class=\"custom-control custom-checkbox\">'+\r\n                                  '<input type=\"checkbox\" class=\"custom-control-input '+this_class+' custom-control custom-checkbox '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                    '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                '</div>'+\r\n                              '</td>';\r\n            }\r\n            question_td += '</tr></table>'+feedback_string;\r\n          break;\r\n\r\n          case \"checkbox_single\":\r\n            feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n            var this_option = this_row[\"answers\"];\r\n            question_td +=  response_html +\r\n                            '<div class=\"btn-group-toggle\" data-toggle=\"buttons\">'+\r\n                                '<label class=\"btn btn-outline-primary\">'+\r\n                                    '<input type=\"checkbox\" class=\"'+this_row[\"item_name\"]+'_item row_'+row_no+'\"  checked autocomplete=\"off\" id=\"'+this_row[\"item_name\"]+'\" onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+ this_option +\r\n                                '</label>'+\r\n                            '</div>' + feedback_string;\r\n          break;\r\n\r\n          case \"date\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td+=   response_html+\r\n                              \"<input onchange='response_check(this)' class='custom-control datepicker date \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\"+\r\n                              feedback_string;\r\n          break;\r\n\r\n          case \"dropdown\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              var options = this_row[\"answers\"].split(\"|\");\r\n              question_td += response_html +\r\n                                  '<select class=\"custom-select '+this_row[\"item_name\"]+'_item row_'+row_no+'\" onchange=\"response_check(this)\" collector_button\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                      '<option selected disabled hidden>-- no option selected --</option>';\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td += \"<option>\"+options[i]+\"</option>\";\r\n              }\r\n              question_td += '</select>'+feedback_string;\r\n          break;\r\n\r\n          case \"email\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<input class='form-control type='email' \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"google_slide\":\r\n          case \"instruct\":\r\n              //question_td += </td>\"; // \"<span class='text-primary'>\" + this_row[\"text\"] + \"</span>\";\r\n          break;\r\n\r\n          // tidy up this code for nice looking buttons\r\n          case \"likert\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              console.dir(\"break coming up, ja?\");\r\n              console.dir(this_row);\r\n              var options  = this_row[\"answers\"].split(\"|\");\r\n              if(typeof(this_row[\"values\"]) == \"undefined\"){\r\n                this_row[\"values\"] = this_row[\"answers\"];\r\n              }\r\n              var values   = this_row[\"values\"].split(\"|\");\r\n              question_td += \"<table class='likert_table'><tr>\" +\r\n                                  '<td>'+\r\n                                      response_html +\r\n                                      '<div class=\"btn-group btn-group-toggle\" data-toggle=\"buttons\">'; //to help detect blank likert's\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td+=   '<button type=\"button\" class=\"btn btn-outline-primary '+this_row[\"item_name\"]+'_item row_'+row_no+'\"  autocomplete=\"off\" id=\"likert_'+row_no+'_'+i+'\"  onclick=\"likert_update(this,\\''+options[i]+'\\',\\''+values[i]+'\\')\">'+options[i]+'</button>';\r\n\r\n              }\r\n              question_td +=  \"</div>\"+\r\n                              \"<input type='hidden' class='\"+this_class+\"' id='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score' name='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score'>\"+\r\n                          \"</td>\"+\r\n                      \"</tr>\"+\r\n                  \"</table>\"+feedback_string;\r\n          break;\r\n\r\n          case \"number\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html +\"<input type='number'  onchange='response_check(this)' class='form-control \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\" + feedback_string;\r\n          break;\r\n\r\n          case \"para\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<textarea name='survey_\"+this_row['item_name'].toLowerCase()+\"' class='\"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' style='width:100%;height:200px'></textarea>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"radio\":\r\n          case \"radio_vertical\":\r\n            var options = this_row[\"answers\"].split(\"|\");\r\n            var values   = this_row[\"values\"].split(\"|\");\r\n            question_td +=  response_html;\r\n            for(var i=0; i<options.length;i++){\r\n              feedback_string = generate_feedback_string(feedback_array,i,feedback_color,row_no,this_row);\r\n\r\n              question_td +=  '<div class=\"custom-control custom-radio\">'+\r\n                                '<input type=\"radio\" class=\"custom-control-input '+this_class+'  onclick=\"likert_update(this,\\''+options[i]+'\\',\\''+values[i]+'\\')\" custom-control custom-radio '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" value=\"' + options[i] + '\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                  feedback_string +\r\n                              '</div>';\r\n\r\n\r\n            }\r\n            question_td +=  \"<input type='hidden' class='\"+this_class+\"' id='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score' name='survey_\"+this_row[\"item_name\"].toLowerCase()+\"_score'>\";\r\n          break;\r\n\r\n          case \"radio_horizontal\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              var options = this_row[\"answers\"].split(\"|\");\r\n              question_td +=  response_html;\r\n              for(var i=0; i<options.length;i++){\r\n                  question_td +=  '<div class=\"custom-control custom-radio custom-control-inline\">'+\r\n                                      '<input type=\"radio\" class=\"custom-control-input '+this_class+' custom-control custom-radio '+this_row[\"item_name\"]+'_item row_'+row_no+'\" id=\"'+this_row[\"item_name\"]+ i +'\"  onchange=\"response_check(this)\" name=\"survey_'+this_row[\"item_name\"].toLowerCase()+'\">'+\r\n                                      '<label class=\"custom-control-label\" for=\"'+this_row[\"item_name\"]+i+'\">'+options[i]+'</label>'+\r\n                                      '<div class=\"invalid-feedback\">Example invalid feedback text</div>'+\r\n                                  '</div>'\r\n              }\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n          case \"report_score\":\r\n              question_td += \"<input disabled class='form-control score_\" + this_row[\"item_name\"] + \" \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n          break;\r\n\r\n          case \"text\":\r\n              feedback_string = generate_feedback_string(feedback_array,0,feedback_color,row_no,this_row);\r\n              question_td += response_html+\"<input class='form-control \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' onchange='response_check(this)' type='text' name='survey_\"+this_row['item_name'].toLowerCase()+\"'>\";\r\n              question_td += feedback_string;\r\n          break;\r\n\r\n      }\r\n    }\r\n    if(feedback_array){\r\n        question_td += \"<button class='btn btn-outline-info feedback_btn \"+this_row[\"item_name\"]+\"_item row_\"+row_no+\"' data-toggle='tooltip' id='reveal_\"+this_row[\"item_name\"].toLowerCase()+\"_feedback'  onclick='reveal_answers(this)'>Show</button>\";\r\n    }\r\n  }\r\n//  question_td += '</td>';\r\n\r\n  if(typeof(this_row[\"type\"])== \"undefined\"){\r\n      return '';\r\n  } else {\r\n    if(this_row[\"type\"].toLowerCase()==\"instruct\"){\r\n      var this_row_html=\"<td colspan='2' class='text-primary'>\"+this_row[\"text\"]+\"</label></td>\";\r\n    } else if(this_row[\"type\"].toLowerCase()==\"google_slide\") {\r\n      var this_row_html=\"<td colspan='2'>\"+this_row[\"text\"]+\"</label></td>\";\r\n    } else if(typeof(this_row[\"no_text\"]) !== \"undefined\" && this_row[\"no_text\"] == \"on\"){\r\n      var this_row_html=\"<td colspan='2'>\"+question_td+\"</td>\";\r\n    } else {\r\n      if(this_row['text'].toLowerCase() == \"page_start\" | this_row['type'].toLowerCase() == \"page_start\"){\r\n        this_row_html = question_td;\r\n      }else {\r\n        var this_row_html=\"<td id='survey_\"+this_row[\"item_name\"].toLowerCase().replace(\" \",\"_\")+\"_question' style='width:\"+row_ques_perc+\"'>\"+this_row[\"text\"]+\"</td><td>\"+question_td+\"</label></td>\";\r\n      }\r\n    }\r\n    if(typeof(this_row[\"optional\"]) !== \"undefined\"){\r\n      if(this_row[\"optional\"].toLowerCase() == \"no\"){\r\n        proceed_object.name.push(this_row[\"item_name\"]);\r\n        proceed_object.type.push(this_row[\"type\"]);\r\n        proceed_object.break_no.push(page_break_management.breaks_remaining);\r\n      }\r\n    }\r\n    if(typeof(this_row[\"shuffle\"]) == \"undefined\" || this_row[\"shuffle\"].toLowerCase() == \"off\"){\r\n      this_shuffle='none';\r\n    } else {\r\n      this_shuffle=this_row[\"shuffle\"];\r\n    }\r\n    return [this_row_html,this_shuffle];\r\n  }\r\n}\r\n\r\nfunction quest_resp_perc(quest_resp_rat){\r\n  if(typeof(quest_resp_rat) == \"undefined\"){\r\n    row_resp_perc = \"35%\";\r\n    row_ques_perc = \"65%\";\r\n  } else {\r\n    row_resp_perc = parseFloat(100-quest_resp_rat.replace(\"%\",\"\"))+\"%\";\r\n    row_ques_perc = parseFloat(quest_resp_rat.replace(\"%\",\"\"))+\"%\";\r\n  }\r\n  return [row_ques_perc,row_resp_perc];\r\n}\r\n\r\nfunction response_check(submitted_element){\r\n  switch(submitted_element.type){\r\n    case \"checkbox\":\r\n      var checked_responses = $(\"[name='\"+submitted_element.name+\"']:checked\");\r\n      if(checked_responses.length){ //i.e. more than 0\r\n        var values = [];\r\n        for(var i = 0; i < checked_responses.length; i++){\r\n          values.push(checked_responses[i].value);\r\n        }\r\n        $(\"#\"+submitted_element.name+\"_response\").val(JSON.stringify(values));\r\n      } else {\r\n        $(\"#\"+submitted_element.name+\"_response\").val(\"\");\r\n      }\r\n      break;\r\n\r\n      case \"button\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.innerHTML);\r\n      break;\r\n\r\n      case \"number\":\r\n      case \"select-one\":\r\n      case \"text\":\r\n      case \"textarea\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.value);\r\n      break;\r\n\r\n\r\n      case \"radio\":\r\n        $(\"#\"+submitted_element.name+\"_response\").val(submitted_element.value);\r\n      break;\r\n    }\r\n    update_score();\r\n}\r\n\r\nfunction retrieve_feedback(this_row){\r\n  if(typeof(this_row[\"feedback\"]) !== \"undefined\" && this_row[\"feedback\"] !== \"\"){\r\n    feedback_array = this_row[\"feedback\"].split(\"|\");\r\n    if(typeof(this_row[\"feedback_color\"]) == \"undefined\"){\r\n      bootbox.alert(\"The color for the feedback options has not been set. If you created this questionnaire, please add a column 'feedback_color' to your survey and separate the colors by a pipe (|) character.\");\r\n    }\r\n    feedback_color = this_row[\"feedback_color\"].split(\"|\");\r\n  } else {\r\n    feedback_array = null;\r\n    feedback_color = '';\r\n  }\r\n  return [feedback_array,feedback_color];\r\n}\r\n\r\nfunction retrieve_row_no_item_name(this_element){\r\n  var these_classes = this_element.className.split(\" \");\r\n  var row_no;\r\n  var item_name;\r\n  these_classes.forEach(function(this_class){\r\n    if (this_class.indexOf('row_') > -1) {\r\n      row_no = this_class.replace(\"row_\",\"\");\r\n    }\r\n    if (this_class.indexOf('_item') > -1) {\r\n      item_name = this_class.replace(\"_item\",\"\").toLowerCase();\r\n    }\r\n  });\r\n  return [row_no,item_name];\r\n}\r\n\r\nfunction reveal_answers(this_element){\r\n  var this_response = $(\"#\"+this_element.id.replace(\"reveal_\",\"survey_\").replace(\"_feedback\",\"_response\")).val();\r\n  response_present = this_response == \"\" ? false : true;\r\n\r\n  if(settings.feedback_before_response == false && response_present == false){\r\n    bootbox.alert(\"Please respond before trying reveal the feedback.\")\r\n  } else {\r\n    if($(\"#\"+this_element.id).hasClass(\"btn-outline-info\")){\r\n      $(\".\"+this_element.id.replace(\"reveal_\",\"\")).show(500);\r\n      if(settings.lock_after_feedback){\r\n        var item_class = this_element.id.replace(\"_feedback\",\"_item\").replace(\"reveal_\",\"\");\r\n        $(\".\"+item_class).prop(\"disabled\",true);\r\n        document.getElementsByClassName(item_class).title = \"The person creating this content has set it so that your answers are locked in once you have chosen to see the feedback\";\r\n        $(\"#\"+this_element.id).addClass(\"btn-info\");\r\n        $(\"#\"+this_element.id).removeClass(\"btn-outline-info\");\r\n        $(\"#\"+this_element.id).html(\"Locked\");\r\n        document.getElementById(this_element.id).title = 'The person creating this content has set it so that your answers are locked in once you have chosen to see the feedback';\r\n        $(\"#\"+this_element.id).addClass(\"disabled\");\r\n      } else {\r\n        $(\"#\"+this_element.id).html(\"Hide\");\r\n        $(\"#\"+this_element.id).removeClass(\"btn-outline-info\");\r\n        $(\"#\"+this_element.id).addClass(\"btn-info\");\r\n      }\r\n    } else {\r\n      $(\"#\"+this_element.id).html(\"Show\");\r\n      $(\".\"+this_element.id.replace(\"reveal_\",\"\")).hide(500);\r\n      $(\"#\"+this_element.id).addClass(\"btn-outline-info\");\r\n      $(\"#\"+this_element.id).removeClass(\"btn-info\");\r\n    }\r\n  }\r\n}\r\n\r\nfunction shuffle(array) {                                   // http://stackoverflow.com/questions/962802#962890\r\n  var tmp, current, top = array.length;\r\n  if(top) while(--top) {\r\n    current = Math.floor(Math.random() * (top + 1));\r\n    tmp = array[current];\r\n    array[current] = array[top];\r\n    array[top] = tmp;\r\n  }\r\n  return array;\r\n}\r\n\r\nfunction update_score(){\r\n  var scales = Object.keys(survey_obj.scales);\r\n  scales.forEach(function(scale){\r\n    this_scale = survey_obj.scales[scale];\r\n    var questions = Object.keys(this_scale.questions);\r\n    var this_score = 0;\r\n    complete_score = true;\r\n\r\n    questions.forEach(function(row_no){\r\n      var item = survey_obj.data[row_no].item_name.toLowerCase();\r\n      var this_response = $(\"#survey_\"+item+\"_response\").val(); //response\r\n      var normal_reverse = this_scale.questions[row_no];\r\n\r\n      if(normal_reverse.indexOf(\"-\") == -1){\r\n        var multiplier = parseFloat(normal_reverse.replace(\"r\",\"\"));\r\n        if(normal_reverse.indexOf(\"r\") == 0){ //reverse the values\r\n          this_value = process_item_score(survey_obj,row_no,\"values\",this_response,item,\"r\");\r\n        } else {\r\n          this_value = process_item_score(survey_obj,row_no,\"values\",this_response,item);\r\n        }\r\n      } else {\r\n        values_reverse = normal_reverse.split(\"-\");\r\n        values_col     = values_reverse[0].toLowerCase();\r\n        normal_reverse = values_reverse[1];\r\n        var multiplier = parseFloat(normal_reverse.replace(\"r\",\"\"));\r\n\r\n        if(normal_reverse.indexOf(\"r\") == 0){ //reverse the values\r\n          this_value = process_item_score(survey_obj,row_no,values_col,this_response,item,\"r\");\r\n        } else {\r\n          this_value = process_item_score(survey_obj,row_no,values_col,this_response,item);\r\n        }\r\n      }\r\n      if(typeof(this_value) !== \"undefined\"){\r\n        this_score += multiplier * this_value;\r\n      } else {\r\n        complete_score = false;\r\n      }\r\n    });\r\n    if(complete_score){\r\n      $(\".score_\"+scale).addClass(\"bg-success\");\r\n      $(\".score_\"+scale).removeClass(\"bg-danger\");\r\n      $(\".score_\"+scale).addClass(\"text-light\");\r\n      document.getElementsByClassName(\"score_\"+scale).title = 'All relevant questions have been answered';\r\n    } else {\r\n      $(\".score_\"+scale).removeClass(\"text-success\");\r\n      $(\".score_\"+scale).addClass(\"bg-danger\");\r\n      $(\".score_\"+scale).addClass(\"text-light\");\r\n      document.getElementsByClassName(\"score_\"+scale).title = 'At least one relevant questions has NOT been answered';\r\n    }\r\n    $(\".score_\"+scale).val(this_score);\r\n  });\r\n}\r\n\r\nfunction write_survey(this_survey,this_id){\r\n  scoring_object.update_scales(this_survey);\r\n  this_survey_html=\"<table class='table_break' id='table0'>\";\r\n  this_survey_object={\r\n    content:[],\r\n    shuffle:[],\r\n    content_new_order:[],\r\n    shuffled_content:[],\r\n    shuffled_arrays:{},\r\n  }\r\n\r\n  this_survey_html += \"<tr>\";\r\n  for(i = 0; i < this_survey.length; i++){\r\n    this_row = this_survey[i];\r\n    row_html = process_survey_question(this_row,i);\r\n    this_survey_object.content.push(row_html[0]);\r\n    this_survey_object.shuffle.push(row_html[1]);\r\n\t}\r\n\r\n\tunique_shuffles = this_survey_object.shuffle.filter((v,i,a)=>a.indexOf(v)==i); //by Camilo Martin on https://stackoverflow.com/questions/1960473/unique-values-in-an-array\r\n\r\n\tfor(var i=0;i<unique_shuffles.length;i++){\r\n    if(typeof(unique_shuffles[i]) !== \"undefined\" &&\r\n      unique_shuffles[i] !== \"none\" &&\r\n      unique_shuffles[i] !== \"\"){\r\n        shuffled_content = this_survey_object.shuffle.map(function(element,index){\r\n    \t   if(typeof(element)!== \"undefined\" && element.toLowerCase() !== \"none\" && element.toLowerCase() == unique_shuffles[i]){\r\n  \t       return this_survey_object.content[index];\r\n    \t   }\r\n    \t}).filter(elm => typeof(elm) !== \"undefined\");\r\n    \tnew_order = shuffle(shuffled_content);\r\n    \tthis_survey_object.shuffled_arrays[unique_shuffles[i]]=new_order; // add new array with dynamic name\r\n    }\r\n\t}\r\n\r\n\t// loop through lists, taking one off from the shuffled list and replacing the row with one from the shuffled list\r\n\tfor(var i=0;i<this_survey_object.content.length;i++){\r\n    var this_index = Object.keys(this_survey_object.shuffled_arrays).indexOf(this_survey_object.shuffle[i]);\r\n    if(this_index !== -1){\r\n      //take first item off relevant list and delete item\r\n      var this_item = this_survey_object.shuffled_arrays[Object.keys(this_survey_object.shuffled_arrays)[this_index]].shift();\r\n      this_survey_object.content_new_order[i]=this_item;\r\n    } else {\r\n      this_survey_object.content_new_order[i]=this_survey_object.content[i];\r\n    }\r\n\t}\r\n\r\n\tquestions_in_order = this_survey_object.content_new_order.join(\"</tr><tr>\");\r\n\tquestions_in_order += \"</tr>\";\r\n\r\n\tthis_survey_html += questions_in_order;\r\n\tthis_survey_html += \"</table>\";\r\n\r\n\t$(\"#\" + this_id).html(this_survey_html);\r\n\t$(\"#\" + this_id).show(1000);\r\n\r\n\t//scroll to top\r\n\r\n\r\n\t$(\".show_tab\").on(\"click\",function(){\r\n    if(this.className.indexOf(\"disabled\") == -1){\r\n      $(\".show_tab\").removeClass(\"active\");\r\n      $(\".survey_page\").hide();\r\n      $(\"#\"+this.id.replace(\"_button\",\"\")).show();\r\n    } else {\r\n      bootbox.alert(\"You have not yet unlocked this tab - maybe try clicking on <b>Proceed</b>?\");\r\n    }\r\n\t});\r\n  $('[data-toggle=\"tooltip\"]').tooltip();\r\n  $(\".custom-checkbox\").prop(\"indeterminate\",true);\r\n}\r\n\r\n//////////////////\r\n// Load survey  //\r\n//////////////////\r\ncurrent_survey = \"{{survey}}\";\r\nif(typeof(Trial) !== \"undefined\"){  // This check is to help this code work when previewing trialtypes\r\n  Trial.set_timer(function(){       // This chunk is for when the survey is run within an actual trial\r\n    load_survey(current_survey);\r\n  },100);\r\n} else {                            // This chunk is for when the survey is being previewed in the \"survey editor\"\r\n  load_survey(current_survey);\r\n}\r\n\r\n\r\n</script>", "instruct": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n-->\r\n<style>\r\n#instruct_text{\r\n  margin:auto;\r\n  width:500px;\r\n  padding:50px;\r\n  max-height:600px;\r\n  text-align: center;  \r\n}\r\n#proceed_button{\r\n  position:absolute;\r\n  right: 20px;\r\n}\r\n#trial_contents{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:600;\r\n}\r\n</style>\r\n<div id=\"trial_contents\">\r\n  <div id=\"instruct_text\">{{text}}</div>\r\n  <div>\r\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\r\n  </div>\r\n</div>"}, "trialtype": "class_vote_teacher", "filetype": "", "version": 0, "user_trialtypes": {"stroop": "hi\n", "finger_imitation": "<style>\n#everything{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#face_image{\n/*  display:none; */\n}\n</style>\n<div id=\"everything\">\n  <div id=\"instructions\">\n    Please put your <b>right index finger</b> on the <b>N</b> key, and your <b>right middle finger</b> on the <b>M</b> key.\n  </div>\n  <img id=\"face_image\" src=\"../User/Stimuli/{{face}}\" />\n</div>\n<button onclick=\"Trial.submit()\">Proceed</button>\n\n<script>\n//detect when both the index and middle finger are down\n\n//$(\"#\")\n\n</script>", "instruct": "<!--\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\n    A program for running experiments on the web\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\n\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License version 3 as published by\n    the Free Software Foundation.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\n \t\t\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\n*/\n-->\n<style>\n#instruct_text{\n  margin:auto;\n  width:500px;\n  padding:50px;\n  max-height:600px;\n  text-align: center;  \n}\n#proceed_button{\n  position:absolute;\n  right: 20px;\n}\n#trial_contents{\n  position: absolute;\n  top:0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  margin:auto;\n  width:600;\n  height:600;\n}\n</style>\n<div id=\"trial_contents\">\n  <div id=\"instruct_text\">{{text}}</div>\n  <div>\n    <button class=\"btn btn-primary\" id=\"proceed_button\" onclick=\"Trial.submit()\">Proceed</button>\n  </div>\n</div>", "class_vote_student": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\nThis makes heavy use of amcharts - available at https://www.amcharts.com/\r\n\r\n-->\r\n<style>\r\n.submit_response_btn{\r\n  width:100%;\r\n}\r\n#response_table{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:300;\r\n  height:300;\r\n  display:none;\r\n}\r\n#start_quiz_btn{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:100;\r\n  height:50;\r\n}\r\n</style>\r\n<button class=\"btn btn-primary\" id=\"start_quiz_btn\">Start</button>\r\n<div id=\"response_table\"></div>\r\n\r\n\r\n<!-- Chart code -->\r\n<script>\r\n\r\n//wrap the below into a tidy object at some point.\r\n\r\nvar participant_code = makeid(10);\r\nvar question_no      = -1;\r\n\r\n\r\ndata = {\r\n  question_id: \"{{question_id}}\",\r\n  response_id: \"{{response_id}}\",\r\n  action:      \"start_student\",\r\n  participant_code: participant_code\r\n};\r\n  \r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet\r\n    refresh_question();\r\n  });\r\n});\r\n\r\nfunction refresh_question(){\r\n  ParseGSX.parseGSX(data.question_id,function(result){\r\n    show_question(result);\r\n    setTimeout(function(){\r\n      refresh_question();\r\n    },2000);\r\n  });\r\n}\r\n\r\n\r\nfunction show_question(result){\r\n  //identify current row\r\n  question_no = 0;\r\n  result.forEach(function(row,row_index){\r\n    if(row.complete == \"yes\"){\r\n      question_no = row_index + 1;\r\n    }\r\n  });\r\n  var this_row         = result[question_no];\r\n  var question         = this_row.question;\r\n  var responses        = this_row.responses.split(\"|\");\r\n  var correct_response = this_row.correct_response;\r\n  \r\n  var response_table_html = \"<table>\" + \r\n                              \"<tr>\" +\r\n                                \"<td><h4>\" + question + \"</h4><br><br></td>\" + \r\n                              \"</tr>\";\r\n  responses.forEach(function(response){\r\n    response_table_html += \"<tr><td><button class='btn btn-primary submit_response_btn'>\" + response + \"</button></td></tr>\";\r\n  });                  \r\n  response_table_html += \"</table>\";\r\n                              \r\n  $(\"#response_table\").html(response_table_html);\r\n  $(\".submit_response_btn\").on(\"click\",function(){\r\n    submit_response(this.innerHTML);\r\n  });\r\n  $(\"#response_table\").show();\r\n  $(\"#start_quiz_btn\").hide();\r\n}\r\n\r\nfunction submit_response(response){\r\n  console.dir(question_no);\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      \"vote\",\r\n    question_no: question_no,\r\n    participant_code: participant_code,\r\n    response: response\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(result){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    /*\r\n    ParseGSX.parseGSX(data.question_id,function(result){\r\n      show_question(result);\r\n    });\r\n    */\r\n  });\r\n}\r\n\r\nresponse_obj = {\r\n  question_no : -1,\r\n  responses   : []\r\n}\r\n\r\n\r\n\r\n\r\n    \r\nvar ParseGSX = (function() {\r\n\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.ajax(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n\r\n  return { parseGSX: parseGSX };\r\n\r\n})();\r\n\r\n\r\n//based on solution by csharptest.net at https://stackoverflow.com/questions/1349404/generate-random-string-characters-in-javascript\r\nfunction makeid(length) {\r\n   var result           = '';\r\n   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmonpqrstuvwxyz1234567890';\r\n   var charactersLength = characters.length;\r\n   for ( var i = 0; i < length; i++ ) {\r\n      result += characters.charAt(Math.floor(Math.random() * charactersLength));\r\n   }\r\n   return result;\r\n}\r\n\r\n\r\n</script>", "class_vote_teacher": "<!--\r\n/*  Collector (Garcia, Kornell, Kerr, Blake & Haffey)\r\n    A program for running experiments on the web\r\n    Copyright 2012-2016 Mikey Garcia & Nate Kornell\r\n\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License version 3 as published by\r\n    the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>\r\n \t\t\r\n\t\tKitten release (2019) author: Dr. Anthony Haffey (a.haffey@reading.ac.uk)\t\t\r\n*/\r\n\r\n-->\r\n<style>\r\n#before_start{\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:300;\r\n}\r\n#chartdiv {\r\n  width: 100%;\r\n  height: 600px;\r\n}\r\n#header_reveal_table td{\r\n  padding:10px;\r\n}\r\n#hide_results{\r\n  display:none;\r\n}\r\n.text_resp_div{\r\n  padding:10px;\r\n  margin:10px;\r\n  width:100%;\r\n}\r\n#trial_contents{\r\n  display:none;\r\n  position: absolute;\r\n  top:0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  margin:auto;\r\n  width:600;\r\n  height:600;\r\n}\r\n\r\n</style>\r\n<div id=\"before_start\">\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"start_quiz_btn\">Start</button>\r\n  <button class=\"btn btn-primary btn-lg btn-block\" id=\"resume_quiz_btn\">Resume</button>\r\n</div>\r\n<div id=\"trial_contents\">\r\n  <table id=\"header_reveal_table\">\r\n    <tr>\r\n      <td colspan=\"3\">  \r\n        <h1 id=\"question_header\"></h1>\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <!--\r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"show_results\">Reveal</button>    \r\n        <button class=\"btn btn-primary hide_reveal_results\" id=\"hide_results\">Hide</button>    \r\n        -->\r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-danger\" id=\"previous_question_btn\">Previous</button>    \r\n      </td>\r\n      <td>\r\n        <button class=\"btn btn-success\" id=\"next_question_btn\">Next</button>    \r\n      </td>\r\n    </tr>\r\n  </table>\r\n  <div id=\"output_div\"></div>\r\n</div>\r\n\r\n<!-- libraries -->\r\n<script src = \"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js\"></script>\r\n\r\n<!-- local script -->\r\n<script>\r\n\r\noutput_contents = {\r\n  current : \"\",\r\n  list: [],\r\n  js_charts: {}\r\n}\r\n\r\nvar quest_no = 0;\r\n\r\n\r\n// actions by class\r\n$(\".hide_reveal_results\").on(\"click\",function(){\r\n  \r\n  $(\".hide_reveal_results\").hide();\r\n  // show is \"Reveal\" clicked\r\n  if(this.innerHTML == \"Reveal\"){\r\n    $(\"#hide_results\").show();\r\n    $(\"#output_div\").fadeIn(100);\r\n  } else {\r\n  //hide if \"hide\" clicked\r\n    $(\"#show_results\").show();\r\n    $(\"#output_div\").hide();\r\n  }\r\n});\r\n\r\n\r\n\r\n//actions by id: start, next, previous then end\r\n///////////////////////////////////////////////\r\n$(\"#start_quiz_btn\").on(\"click\",function(){\r\n  quest_no = 0;\r\n  post_action(\"start\",function(){\r\n    $(\"#previous_question_btn\").hide(); //by definition cannot need this\r\n    \r\n    //if there's more than one question, then need to see next button.\r\n    //if(quest_array.length > 1){\r\n      $(\"#next_question_btn\").show(); //by definition must need this\r\n    //}\r\n    \r\n    $(\"#before_start\").hide();\r\n    $(\"#trial_contents\").show();\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#next_question_btn\").on(\"click\",function(){\r\n  post_action(\"next\",function(){\r\n    console.dir(\"next clicked\");\r\n    $(\"#previous_question_btn\").show(); //by definition must see this\r\n    quest_no++;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    $(\"#next_question_btn\").show(); //by definition must see this\r\n    quest_no--;\r\n    generate_chart(quest_no);\r\n  });\r\n});\r\n\r\n/* end quiz button\r\n$(\"#previous_question_btn\").on(\"click\",function(){\r\n  post_action(\"previous\",function(){\r\n    ParseGSX.parseGSX(data.response_id,function(result){\r\n      response_obj = result;\r\n      generate_chart();\r\n    });\r\n  });\r\n});\r\n*/\r\n\r\n\r\n\r\n//functions alphabetically\r\n//////////////////////////\r\n\r\nfunction calculate_chart_data(response_obj,local_quest_no){\r\n                                \r\n  local_quest_no = local_quest_no + 1;\r\n                                \r\n  var this_q_resps = response_obj.map(function(row){\r\n    return row[\"q\" + local_quest_no + \"resp\"];\r\n  });\r\n  //identify the frequencies of each unique value\r\n  var counts = {};\r\n  //by typeof at https://stackoverflow.com/questions/5667888/counting-the-occurrences-frequency-of-array-elements\r\n  for (var i = 0; i < this_q_resps.length; i++) {\r\n    var response = this_q_resps[i];\r\n    counts[response] = counts[response] ? counts[response] + 1 : 1;\r\n  }\r\n  return counts;\r\n}\r\n\r\nfunction choice_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  //chartdiv\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<canvas class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></canvas>');\r\n    canvas = document.getElementById(output_id);\r\n    ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    \r\n    output_contents.js_charts[output_id] = new Chart(ctx, {\r\n      type: 'horizontalBar',\r\n      data: {\r\n        labels: all_resps,\r\n        datasets: [{\r\n          label: '# of Votes',\r\n          data: data_values,\r\n          backgroundColor: back_color_array,\r\n          borderColor: bord_color_array,\r\n          borderWidth: 1\r\n        }]\r\n      },\r\n      options: {\r\n        legend: {\r\n          display: false\r\n        },\r\n        scales: {\r\n          xAxes: [{\r\n            ticks: {\r\n              beginAtZero: true,\r\n              fontSize: 20\r\n            }\r\n          }],\r\n          yAxes: [{\r\n            ticks: {\r\n              fontSize: 20\r\n            }\r\n          }]\r\n        }\r\n      }\r\n    });\r\n    output_contents.list.push(output_id);\r\n    \r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction text_question(quest_array, response_obj, local_quest_no){\r\n  [all_resps,\r\n  data_values,\r\n  back_color_array,\r\n  bord_color_array] = resps_values(quest_array,\r\n                                   response_obj,\r\n                                   local_quest_no);\r\n  \r\n  $(\".output_content\").hide();\r\n    \r\n  var unique_resps = list_resps(response_obj,local_quest_no);\r\n  var output_id = 'output' + local_quest_no;\r\n  if(output_contents.list.indexOf(output_id) == -1){\r\n    $(\"#output_div\").append('<div class=\"output_content\" id=\"' + output_id +'\" width=\"400\" height=\"400\"></div>');\r\n\r\n    var output_html = \"\";\r\n    unique_resps.forEach(function(this_resp){\r\n      output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n    }); \r\n    \r\n    $(\"#\" + output_id).html(output_html);\r\n    output_contents.list.push(output_id);\r\n    refresh_output(local_quest_no);\r\n  } else {\r\n    $(\"#\" + output_id).show();\r\n  }\r\n}\r\n\r\nfunction generate_chart(local_quest_no){\r\n  ParseGSX.parseGSX(data.question_id,function(quest_array){\r\n    ParseGSX.parseGSX(data.response_id,function(response_obj){\r\n    \r\n      $(\"#question_header\").html(quest_array[local_quest_no].question);\r\n      \r\n      var quest_type = quest_array[local_quest_no].type;\r\n      \r\n      switch(quest_type.toLowerCase()){\r\n        case \"choice\":\r\n        case \"multiple choice\":\r\n        case \"multiple_choice\":\r\n          choice_question(quest_array,\r\n                          response_obj,\r\n                          local_quest_no);\r\n          break;\r\n        case \"text\":\r\n          text_question(quest_array,\r\n                        response_obj,\r\n                        local_quest_no);\r\n          break;\r\n\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction list_resps(response_obj,this_quest_no){\r\n  this_quest_no = this_quest_no + 1;\r\n  \r\n  var quest_key = \"q\" + this_quest_no + \"resp\";\r\n  var unique_resps = [];\r\n  response_obj.forEach(function(row){\r\n    if(unique_resps.indexOf(row[quest_key]) == -1){\r\n      unique_resps.push(row[quest_key]);\r\n    }\r\n  });\r\n  return unique_resps;\r\n}\r\n\r\n\r\nfunction post_action(action,response){\r\n  data = {\r\n    question_id: \"{{question_id}}\",\r\n    response_id: \"{{response_id}}\",\r\n    action:      action\r\n  };\r\n  $.ajax({\r\n    type: 'POST',\r\n    url: \"{{script_url}}\",\r\n    data: data,\r\n    crossDomain: true,\r\n    timeout: 120000,\r\n    success:function(response){\r\n      //as it stands, this will never happen as Collector doesn't allow posts to it.\r\n    }\r\n  })\r\n  .catch(function(error){\r\n    //read the google sheet \r\n    response();\r\n  });\r\n}\r\n\r\nfunction refresh_output(local_quest_no){\r\n  \r\n  console.dir(\"local_quest_no\");\r\n  console.dir(local_quest_no);\r\n  \r\n  var output_id = 'output' + local_quest_no;\r\n  \r\n  var url = \"https://spreadsheets.google.com/feeds/list/{{response_id}}/od6/public/values?alt=json\";\r\n  $.get(url,function(res){\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    \r\n    var chartCount = calculate_chart_data(finalData,\r\n                                      local_quest_no);\r\n    \r\n\r\n    \r\n    //identify what type of question it is!\r\n      //identify what the class of the visible output_content is\r\n    var element_type = $(\".output_content:visible\")[0].tagName.toLowerCase();\r\n    \r\n    switch(element_type){\r\n      case \"canvas\":\r\n      var labels = output_contents.js_charts[output_id].data.labels;\r\n      \r\n      var data_values = labels.map(function(key){\r\n        if(typeof(chartCount[key]) !== \"undefined\"){\r\n          return chartCount[key];\r\n        } else {\r\n          return 0;\r\n        }\r\n      });\r\n      \r\n      output_contents.js_charts[output_id].data.datasets[0].data = data_values;\r\n      output_contents.js_charts[output_id].update();        \r\n        break;\r\n        \r\n      case \"div\":\r\n        var unique_resps = list_resps(finalData,local_quest_no);\r\n        \r\n        var output_html = \"\";\r\n        unique_resps.forEach(function(this_resp){\r\n          output_html += \"<button class='btn btn-primary text_resp_div'>\" + this_resp + \"</button>\";\r\n        }); \r\n        \r\n        $(\"#\" + output_id).html(output_html);\r\n        break;\r\n    }\r\n\r\n    \r\n    setTimeout(function(){\r\n      refresh_output(local_quest_no);\r\n    },1000);  \r\n  });\r\n  \r\n  /*\r\n  if (callback) { _defaultCallback = callback; }\r\n  $.when(ajax).then(_parseRawData);\r\n  */\r\n  \r\n}\r\n\r\nfunction resps_values(quest_array, response_obj, local_quest_no){\r\n  \r\n  console.dir(quest_array);\r\n  console.dir(JSON.stringify(quest_array));\r\n  \r\n                        \r\n  chartCount        = calculate_chart_data(response_obj,\r\n                                           local_quest_no);\r\n                                           \r\n  var all_resps     = quest_array[local_quest_no].responses.split(\"|\");\r\n  var correct       = quest_array[local_quest_no].correct;\r\n  var correct_index = all_resps.indexOf(correct);\r\n  \r\n  var correct_color = 'rgba(75, 192, 192,'; //  0.8)';\r\n  var wrong_color   = 'rgba(255, 99, 132,'; //  0.8)';\r\n  var neutral_color = 'rgba(54, 162, 235,'; //  0.8)';\r\n  \r\n  //colors if there is no correct answer\r\n  if(correct_index == -1){\r\n    back_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 0.8)\";\r\n    });\r\n    bord_color_array = all_resps.map(function(row){\r\n      return neutral_color + \" 1)\";\r\n    });\r\n  } else {\r\n    back_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 0.8)\";\r\n      } else {\r\n        return wrong_color + \" 0.8)\";  \r\n      }\r\n    });\r\n    bord_color_array = all_resps.map(function(row,index){\r\n      if(index == correct_index){\r\n        return correct_color + \" 1)\";\r\n      } else {\r\n        return wrong_color + \" 1)\";\r\n      }\r\n    });\r\n  }\r\n  \r\n  var data_values = all_resps.map(function(key){\r\n    if(typeof(chartCount[key]) !== \"undefined\"){\r\n      return chartCount[key];\r\n    } else {\r\n      return 0;\r\n    }\r\n  });\r\n  \r\n  return [all_resps,\r\n          data_values,\r\n          back_color_array,\r\n          bord_color_array];\r\n}\r\n\r\n//Code from online sources\r\n//////////////////////////\r\n\r\n//based on code found at: https://raw.githubusercontent.com/drumwolf/parse-gsx/0ba67bf115eac96e0763777a4fb2c485a35e2daa/parse-gsx-ajax.js\r\nvar ParseGSX = (function() {\r\n  var _defaultCallback = function(data) {\r\n    console.log(data);\r\n  };\r\n  var _parseRawData = function(res) {\r\n    var finalData = [];\r\n    res.feed.entry.forEach(function(entry){\r\n      var parsedObject = {};\r\n      for (var key in entry) {\r\n        if (key.substring(0,4) === \"gsx$\") {\r\n          parsedObject[key.slice(4)] = entry[key][\"$t\"];\r\n        }\r\n      }\r\n      finalData.push(parsedObject);\r\n    });\r\n    var processGSXData = _defaultCallback;\r\n    processGSXData(finalData);\r\n  };\r\n  var parseGSX = function(spreadsheetID, callback) {\r\n    var url = \"https://spreadsheets.google.com/feeds/list/\" + spreadsheetID + \"/od6/public/values?alt=json\";\r\n    var ajax = $.get(url);\r\n    if (callback) { _defaultCallback = callback; }\r\n    $.when(ajax).then(_parseRawData);\r\n  };\r\n  return { parseGSX: parseGSX };\r\n})();\r\n\r\n</script>"}, "graphic": {"trialtype": "", "trialtypes": {}, "hovered_element": "", "relevant_styles": ["background-color", "border-color", "border-radius", "border-style", "border-width", "color", "font-size", "height", "left", "top", "width", "z-index"]}}, "data": {"scripts": {}, "save_script": "https://script.google.com/macros/s/AKfycbyMQS4T2DpGkq6Ue4IDaRVHKKuQXoOnCm0116m92hmQTfn-Syk/exec"}, "autoloaded_boosts": {}, "keys": {"public_key": "qbLtY/WKogexV2MtzKeCjHng8DKNjOOmIfEnpj1Z90A=", "encrypted_private_key": "U2FsdGVkX19VVuPYnst4/UihYRbzoVvZ9thDaa9wKj92VEVshI5d6ce/Zvn66e79pEkPgyvcHKI3e8j5KagXwg==", "archived": [{"public_key": "QPtLJXI7PBoV4rtaqFqRYHG46NLRC/7N5ECNu3UNsx8=", "encrypted_private_key": "U2FsdGVkX1+qF53bb1UJ8jEN9q9/6aIClh7XqeWp2U6E07F702BvxUJWgEUX5jD+fyJI1W2av6wwhD1nO3srFg=="}]}, "github": {"organisation": "anthonyhaffey", "username": "anthonyhaffey", "repository": "py2rm-collector"}}